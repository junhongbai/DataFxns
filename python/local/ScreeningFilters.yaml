id: 8afde97e-5f64-4314-ae2c-e4c821a6b002
name: Filter Compounds For Issues
description: Run various screening filters on a set of compounds
category: Chemistry
version: 1.0.0
serviceName: Script
serviceUri: glysade.python
executorId: Glysade.CPythonDataFxn
inputFields:
- control:
    id: structureColumn
    label: Select Reagents Column
    type: columnselect
    filters:
      - dataType: string
        contentType:
          - chemical/x-mdl-molfile
          - chemical/x-mdl-molfile-v3000
          - chemical/x-smiles
          - chemical/x-daylight-smiles
      - dataType: binary
        contentType:
          - chemical/x-mdl-molfile
          - chemical/x-mdl-molfile-v3000
    validationRules:
      - type: required
        message: Must select column of 2D structures for reagents
  request:
    id: structureColumn
    dataType: string
    selectorType: column
- control:
    id: screening_filters
    label: Select Screening Filters
    type: select
    multi: !!bool true
    options:
    - value: brenk
      text: Brenk Screening Filter (Dundee University)
    - value: bms
      text: Bristol Myers Squibb Screening Filters
    - value: glaxo
      text: Glaxo Smith Kline Screening filters
    - value: chembl rings
      text: ChEMBL Ring System Check
    - value: inpharmatica
      text: Inpharmatica Screening Filters
    - value: lint
      text: LINT screening filters
    - value: mlsmr
      text: NIH Molecular Libraries Small Molecule Repository Filters
    - value: nih
      text: NIH Screening Filters
    - value: novartis
      text: Novartis Screening Filters
    - value: pains
      text: PAINS (Pan Assay Interference Filters)
    - value: zinc
      text: ZINC Screening Filters
    validationRules:
     - type: oneOrMoreRequired
       message: ''
  request:
    id: screening_filters
    dataType: list(string)
tags:
  - color: '#50AF28'
    text: chemistry
  - color: '#c6fc00'
    text: calcprop
updateBehavior: automatic
maximumOutputColumns: !!int 10
maximumOutputTables: !!int 1
chemistryFunction: !!bool false
script: |
  from collections import defaultdict, deque
  from typing import Optional
  from rdkit import Chem, RDConfig
  from rdkit.Chem import FilterCatalog
  from df.chem_helper import (column_to_molecules, input_field_to_molecule, 
      molecules_to_column)
  from df.data_transfer import (ColumnData, DataFunctionRequest, DataFunctionResponse, DataType,
                                Notification, NotificationLevel, string_list_input_field, string_input_field)
  from ruse.rdkit.rdkit_utils import sanitize_mol
  from pathlib import Path

  import csv, df, gzip, logging, marshal, os, time
  logging.basicConfig()
  logging.getLogger().setLevel(logging.INFO)
  # do we have the chembl ring database?
  RING_DB = Path(df.__file__).parent.parent.parent / 'Data' / 'chembl-rings.marshal.gz'
  if not os.path.exists(RING_DB):
     logging.info(f"RING_DB Cannot be found at {RING_DB}")
     RING_DB = None
     
  
  logging.basicConfig()
  logging.getLogger().setLevel(logging.INFO)

  FilterCatalogs = FilterCatalog.FilterCatalogParams.FilterCatalogs

  CATALOGS = {
          "brenk": FilterCatalogs.BRENK,
          "chembl": FilterCatalogs.CHEMBL,
          "chembl rings": None,
          "bms": FilterCatalogs.CHEMBL_BMS,
          "dundee": FilterCatalogs.CHEMBL_Dundee, # same as brenk
          "glaxo": FilterCatalogs.CHEMBL_Glaxo,
          "inpharmatica": FilterCatalogs.CHEMBL_Inpharmatica,
          "lint": FilterCatalogs.CHEMBL_LINT,
          "mlsmr": FilterCatalogs.CHEMBL_MLSMR,
          "surechambl": FilterCatalogs.CHEMBL_SureChEMBL,
          "nih": FilterCatalogs.NIH,
          "novartis": None, #"novartis", # special
          "pains": FilterCatalogs.PAINS,
          "pains_a": FilterCatalogs.PAINS_A,
          "pains_b": FilterCatalogs.PAINS_B,
          "pains_c": FilterCatalogs.PAINS_C,
          "zinc": FilterCatalogs.ZINC,
      }

  # ['PATTERN_NAME', 'SMARTS', 'MIN_COUNT', 'SEVERITY_SCORE', 'SEVERITY_COMMENT', 'COVALENT', 'SPECIAL_MOL']
  NIBR = [
      ['1_1_di_cyano', 'N#CCC#N', '1', '1', 'FLAG', '1', '0'],
      ['1_3_diazetidine_2_one', '[!#6]=[*]1-[!#6]*[!#6]1', '1', '2', 'EXCLUDE', '0', '0'],
      ['2_2_dimethyl_4_5_dicarboxy_dithiole', 'C1(C)(C)SC(C(=O)O)=C(C(=O)O)S1', '1', '2', 'EXCLUDE', '0', '0'],
      ['2_amino_3_carbonyl_2_thiopene', 'O=C-N-c1scc(-c)c1-C(=O)-O', '1', '1', 'FLAG', '0', '0'],
      ['2_aminothiophene_3_carbaldehyde', '[NH2]-c1sccc1-C=O', '1', '2', 'EXCLUDE', '0', '0'],
      ['2_hydroxy_phenyl_hydrazone', '[#7]-N=!@C-c1ccccc1-[OH]', '1', '2', 'EXCLUDE', '0', '0'],
      ['2_nitro_furans_and_pyrroles', '[O]~N([c;R1]1[c;H1;R1][c;H1][c;R1][n,o]1)~[O]', '1', '1', 'FLAG', '0', '0'],
      ['2_pyridyl_N_hydroxy_imide', 'O=C1-[#6]~[#6]-C(=O)N1-O-c2naaaa2', '1', '2', 'EXCLUDE', '1', '0'],
      ['3_alpha_peptide_cycle', 'C1[C!r3!r4!r5!r6!r7!r8](=O)-NC[C!r3!r4!r5!r6!r7!r8](=O)NC[C!r3!r4!r5!r6!r7!r8](=O)N1', '1', '2', 'EXCLUDE', '0', '1'],
      ['3_consecutive_aliphatic_nitrogen', '[N;!R]-[N;!R]-[N;!R]', '1', '2', 'EXCLUDE', '0', '0'],
      ['3_consecutive_aliphatic_nitrogen_subst', '[N;!$(N-S(=O)(=O));!$(N-C=O)]-[N;!r3;!$(N-S(=O)(=O));!$(N-C=O)]-[N;!$(N-S(=O)(=O));!$(N-C=O)]', '1', '2', 'EXCLUDE', '0', '0'],
      ['3_halo_pyridazine_2_EWG', '[#7;R1]1[#6]([$(S(=O)(=O)),$(C(F)(F)(F)),$(C#N),$(N(=O)(=O)),$([N+](=O)[O-]),$(C=O)])[#6]([F,Cl,Br,I])[#6][#6][#7]1', '1', '2', 'EXCLUDE', '1', '0'],
      ['3_halo_pyridazine_4_EWG', '[#7;R1]1[#6][#6]([F,Cl,Br,I])[#6]([$(S(=O)(=O)),$(C(F)(F)(F)),$(C#N),$(N(=O)(=O)),$([N+](=O)[O-]),$(C=O)])[#6][#7]1', '1', '2', 'EXCLUDE', '1', '0'],
      ['3_ring_unsaturated', '*1:,=*~*~1', '1', '2', 'EXCLUDE', '0', '0'],
      ['3_ring_with_2_heteroatoms', '[!#6]1~[!#6]~*~1', '1', '2', 'EXCLUDE', '1', '0'],
      ['4_hydroxy_phenyl_hydrazone', '[#7]-N=!@C-c1ccc(-[OH])cc1', '1', '2', 'EXCLUDE', '0', '0'],
      ['5_ring_acyl', '[#6]-C(=O)!@-[n;$(n1naaa1),$(n1anaa1)]1[n,c;!$(a=!@A)][n,c;!$(a=!@A)][n,c;!$(a=!@A)][n,c;!$(a=!@A)]1', '1', '0', 'ANNOTATION', '1', '0'],
      ['9_10_diphenyl_anthracene', 'c1(-c2ccccc2)c3ccccc3c(-c4ccccc4)c5ccccc51', '1', '2', 'EXCLUDE', '0', '0'],
      ['acetal_aminal_acyclic', '[O,S&v2,N]-!@[#6;$(C=O),X4]-!@[O,S&v2,N]', '1', '0', 'ANNOTATION', '0', '0'],
      ['acetal_aminal_cyclic', '[O,N]-!@[C;X4;!$(CC(-[OH])C(-[OH])C-[OH])]-@[O,N]', '1', '0', 'ANNOTATION', '0', '0'],
      ['acetyl_urea', 'C(=O)!@N!@C(=O)[#7]', '1', '1', 'FLAG', '0', '0'],
      ['acid_anhydride_acyclic', 'O=[C,P!$(P(~O)(~O)(~O)O),N,S]!@O!@[C,P,N,S]=O', '1', '2', 'EXCLUDE', '0', '0'],
      ['acid_anhydride_cyclic', 'O=[#6,P!$(P(~O)(~O)(~O)O),#7,#16]@[#8]@[#6,#15,#7,#16]=O', '1', '2', 'EXCLUDE', '0', '0'],
      ['acid_anhydrides_2', '[#6]C(=O)!@OC(=!@[N,O])[#6]', '1', '2', 'EXCLUDE', '0', '0'],
      ['acid_count_3', '[C,S,P](=O)[OH].[C,S,P](=O)[OH].[C,S,P](=O)[OH].[C,S,P](=O)[OH]', '1', '2', 'EXCLUDE', '0', '0'],
      ['activated_4membered_ring', '[#6]1~[$(C(=O)),$(S(=O))]~[O,S,N]~[$(C(=O)),$(S(=O))]1', '1', '2', 'EXCLUDE', '0', '0'],
      ['activated_S_or_O_in_3_ring', 'C1~[O,S]~[C,N,O,S]1[a,N,O,S]', '1', '2', 'EXCLUDE', '0', '0'],
      ['acyclic_enolate', 'C=[C!r]O', '1', '0', 'ANNOTATION', '0', '0'],
      ['acyclic_cyanohydrin', 'N#C[C;R0;X4]O[!$(O=[C,S])]', '1', '0', 'ANNOTATION', '0', '0'],
      ['acyclic_enolate', '[O-]-[C;R0]=[C;R0]', '1', '0', 'ANNOTATION', '0', '0'],
      ['acyclic_N-C-N', 'N-!@[CX4]-!@N', '1', '0', 'ANNOTATION', '0', '0'],
      ['acyclic_nitroamino', '[N;R0](~N)~O', '1', '2', 'EXCLUDE', '0', '0'],
      ['acyl_cyanide', 'O=CC#N', '1', '1', 'FLAG', '0', '0'],
      ['adjacent_ring_double_bonds', '[*;R]=[*;R]=[*;R]', '1', '0', 'ANNOTATION', '0', '0'],
      ['aldehyde_aliphatic', '[#6;X4;!$([C;H](O)-[C;H](O)-[C;H](O))]-[C;H1]=[O,S]', '1', '0', 'ANNOTATION', '1', '0'],
      ['aldehyde_aromatic', '[#6;X3,X2]-[#6;H1]=[#8,#16&v2]', '1', '0', 'ANNOTATION', '1', '0'],
      ['aldimin_acyclic', '[C;H1&$([#6]-[#6]),H2]=!@N-[*;!#7;!#8]', '1', '1', 'FLAG', '0', '0'],
      ['alkyl_chain_CH2_count_10', '[C;R0;X4]!@[CH]!@[CH]!@[CH]!@[CH]!@[CH]!@[CH]!@[CH]!@[CH]!@[CH]!@[CH]', '1', '2', 'EXCLUDE', '0', '0'],
      ['allene', 'C=C=C', '1', '1', 'FLAG', '0', '0'],
      ['allyl_terminal', '[#8,#7&v3,#16&v2]-[CH2]-[CH]=[CH2]', '1', '0', 'ANNOTATION', '0', '0'],
      ['alpha_chloro_amides_esters_amidines', 'Cl[C;H2]C([H,NH2,OCH3])=[NH,O]', '1', '0', 'ANNOTATION', '1', '0'],
      ['alpha_cyano_acrylamides', 'O=C(N)[C;X3]C#N', '1', '0', 'ANNOTATION', '0', '0'],
      ['alpha_halo_amine', '[F,Cl,Br,I,$(O(S(=O)(=O)))]-[CH,CH2;!$(C(F)(F))]-[N,n]', '1', '0', 'ANNOTATION', '0', '0'],
      ['alpha_halo_EWG', '[$(C(F)(F)(F)),$(C#N),$(N(=O)(=O)),$([N+](=O)[O-])]-[CH,CH2]-[Cl,Br,I,$(O(S(=O)(=O)))]', '1', '2', 'EXCLUDE', '1', '0'],
      ['alpha_halo_heteroatom', '[N,n,O,S;!$(S(=O)(=O))]-[CH,CH2;!$(C(F)(F))][F,Cl,Br,I,$(O(S(=O)(=O)))]', '1', '0', 'ANNOTATION', '0', '0'],
      ['alpha_peptide', 'C[C!r3!r4!r5!r6!r7!r8!r9](=O)-NC[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)NC', '1', '2', 'EXCLUDE', '0', '1'],
      ['amide_acyclic_count_2', '[#6]-[NH]-!@[C;$(C-[#6])]=O', '2', '0', 'ANNOTATION', '0', '0'],
      ['amidines', 'N=C(-[#6])N', '1', '0', 'ANNOTATION', '0', '0'],
      ['amino_acid', '[NH2][CX4]C(=O)O', '1', '0', 'ANNOTATION', '0', '0'],
      ['amino_acridine', 'c:1:c:2:c(:c:c:c:1):n:c:3:c(:c:2-[#7]):c:c:c:c:3', '1', '2', 'EXCLUDE', '0', '0'],
      ['amino_glycoside_streptamine', 'N-!@C(CC1-!@N)C(-!@OC2OCCCC2)C(-!@O)C1-!@OC3CCC-,=CO3', '1', '2', 'EXCLUDE', '0', '1'],
      ['amino_naphtalimide', 'c1(N)ccc(C(=O)NC3(=O))c(c3ccc2)c21', '1', '1', 'FLAG', '0', '0'],
      ['aminothiazol', 'N-c1nc[cH]s1', '1', '0', 'ANNOTATION', '0', '0'],
      ['aminothiophene_dioxides', '[#6](-[#6](-[#7])=[#6]1)=[#6]-[#16]1(=[#8])=[#8]', '1', '0', 'ANNOTATION', '0', '0'],
      ['aniline_alkyl_ene', 'c:1:c:c-2:c(:c:c:1)-[#6]-3-[#6](-[#6]-[#7]-2)-[#6]-[#6]=[#6]-3', '1', '2', 'EXCLUDE', '0', '0'],
      ['aniline_no_alkyl', 'c:1(:c(:c(:c(:c(:c:1-[#1])-[#1])-[$([#8]),$([#7]),$([#6](-[#1])-[#1])])-[#1])-[#1])-[#7](-[#1])-[#1]', '1', '1', 'FLAG', '0', '0'],
      ['ansa_aromatics', 'a1aa2aaa1-*-*-a3aaa(-*-*-2)aa3', '1', '0', 'ANNOTATION', '0', '0'],
      ['anthracen', 'c12ccccc1cc3ccccc3c2', '1', '2', 'EXCLUDE', '0', '0'],
      ['anthracen_diels_alder_adduct', 'C14-c2c(cccc2)-C(-[#6]~[#6]-1)-c3c(cccc3)-4', '1', '1', 'FLAG', '0', '0'],
      ['anthranil_one', 'c:1:c:c:c:c(:c:1-[#7&!H0;!H1,!$([#7]-[#6]=[#8])])-[#6](-[#6]:[#6])=[#8]', '1', '1', 'FLAG', '0', '0'],
      ['anthrones', '[#6]2=,:[#6]3-,:[#6]4=,:[#6](-,:[#6]=,:[#6]-,:[#6]=,:[#6]4)-,:[#6](=O)-,:[#6]4=,:[#6]3-,:[#6](=,:[#6]-,:[#6]=,:[#6]4)[#7]-,:[#6]2=O', '1', '2', 'EXCLUDE', '0', '0'],
      ['aromatc_alkinyl_hetero_aromatic', 'c-[C]#C-[c;$(c1n[a;!$(a=*)][a;!$(a=*)][a;!$(a=*)]n1),$(c1n[a;!$(a=*)]n[a;!$(a=*)][a;!$(a=*)]1),$(c1nn[a;!$(a=*)][a;!$(a=*)][a;!$(a=*)]1),$(c1c(-[$([#6,#7,#15,#16]~[#8;X1]),$(C#N),$(C=N)])[a;!$(a=*)][a;!$(a=*)][a;!$(a=*)]n1),$(c1n[a;!$(a=*)]c(-[$([#6,#7,#15,#16]~[#8;X1]),$(C#N),$(C=N)])[a;!$(a=*)][a;!$(a=*)]1),$(c1c(-[$([#6,#7,#15,#16]~[#8;X1]),$(C#N),$(C=N)])[a;!$(a=*)]n[a;!$(a=*)][a;!$(a=*)]1)]', '1', '0', 'ANNOTATION', '1', '0'],
      ['aromatic_ether_count_5', 'c-O-[#6;!$([#5]=[!#6])]', '5', '1', 'FLAG', '0', '0'],
      ['aryl_sulfone_activated', '[$(c1naa[o,s]1),$(c1naaaa1)]S(=O)(=O)[#6]', '1', '0', 'ANNOTATION', '1', '0'],
      ['azanitrone', 'N=[N+]([O-])C', '1', '2', 'EXCLUDE', '0', '0'],
      ['azide', '[#7;X2;$([#7]=[#7;X2;+1]=[#7;X1;-1]),$([#7;-1]-[#7;X2;+1]#[#7;X1])]', '1', '0', 'ANNOTATION', '0', '0'],
      ['azide_acylated', '[CH0](=O)[#7;X2;$([#7]=[#7;X2;+1]=[#7;X1;-1]),$([#7;-1]-[#7;X2;+1]#[#7;X1])]', '1', '2', 'EXCLUDE', '0', '0'],
      ['aziridine_episulfide', '[CH2]1-[#7&v3&H1,#16&v2]-[C;X4]1', '1', '2', 'EXCLUDE', '1', '0'],
      ['aziridine_like_N_in_3_membered_ring', 'N~1~*~*1', '1', '0', 'ANNOTATION', '1', '0'],
      ['azocyanamides', '[N;R0]=[N;R0]C#N', '1', '2', 'EXCLUDE', '0', '0'],
      ['basic_amine_count_4', '[N;!$(N(=[N,O,S,C]));!$(N(S(=O)(=O)));!$(N(C(F)(F)(F)));!$(N(C#N));!$(N(C(=O)));!$(N(C(=S)));!$(N(C(=N)));!$(N(#C));!$(N-c)].[N;!$(N(=[N,O,S,C]));!$(N(S(=O)(=O)));!$(N(C(F)(F)(F)));!$(N(C#N));!$(N(C(=O)));!$(N(C(=S)));!$(N(C(=N)));!$(N(#C));!$(N-c)].[N;!$(N(=[N,O,S,C]));!$(N(S(=O)(=O)));!$(N(C(F)(F)(F)));!$(N(C#N));!$(N(C(=O)));!$(N(C(=S)));!$(N(C(=N)));!$(N(#C));!$(N-c)].[N;!$(N(=[N,O,S,C]));!$(N(S(=O)(=O)));!$(N(C(F)(F)(F)));!$(N(C#N));!$(N(C(=O)));!$(N(C(=S)));!$(N(C(=N)));!$(N(#C));!$(N-c)]', '1', '0', 'ANNOTATION', '0', '0'],
      ['benzamidine', '[NH]=C([NH2])c', '1', '0', 'ANNOTATION', '0', '0'],
      ['benzhydrol', '[OH1]-C(-c1ccccc1)c2ccccc2', '1', '0', 'ANNOTATION', '0', '0'],
      ['benzisothiazolone', '[c](:[c]:[c](-[#6](=[#8])-[#7]-[#16]1):[c]1:[c]2):[c]2', '1', '0', 'ANNOTATION', '0', '0'],
      ['benzofurazanes', 'N-S(=O)(=O)c1cccc2c1~[#7;X2]~[#8,#16&X2;$(a1nccn1),$(A1-N=cc=N1),$(S1=N-cc-N=1)]~[#7;X2]~2', '1', '0', 'ANNOTATION', '0', '0'],
      ['benzoisothiazolone', '[#8;$([#8]=[#6]),$([#8]-[#6]=,:[#7])]~[#6]1~[#7]-,:[#16&X2]-,:c2ccccc12', '1', '1', 'FLAG', '0', '0'],
      ['benzothiazol_amine', '[c]1:[c]:[c]:[c](:[s]:[c]2-[#7]-[#6]3-[#6]-[#6]-[#6](-[#6]-[#7])-[#6]-[#6]3):[c](:[c]1):[n]2', '1', '0', 'ANNOTATION', '0', '0'],
      ['beta_alpha_mixed_peptide_1', 'C[C!r3!r4!r5!r6!r7!r8!r9](=O)-NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)NC', '1', '2', 'EXCLUDE', '0', '1'],
      ['beta_alpha_mixed_peptide_2', 'C[C!r3!r4!r5!r6!r7!r8!r9](=O)-NC[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)NC', '1', '2', 'EXCLUDE', '0', '1'],
      ['beta_carbonyl_quaternary_nitrogen', 'C(=O)C[N+,n+]', '1', '2', 'EXCLUDE', '0', '0'],
      ['beta_lactame', 'N1-C(=[O,S])-[#6]~[#6]-1', '1', '0', 'ANNOTATION', '0', '0'],
      ['beta_lactone', '[O,S&v2]=C1-[O,S&v2]-CC1', '1', '0', 'ANNOTATION', '1', '0'],
      ['beta_peptide', 'C[C!r3!r4!r5!r6!r7!r8!r9](=O)-NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)NC', '1', '2', 'EXCLUDE', '0', '1'],
      ['betalactam_EWG', 'C1(=O)~[#6]~[#6]N1([$(S(=O)(=O)[C,c,O&D2]),$(C(F)(F)(F)),$(C#N),$(N(=O)(=O)),$([N+](=O)[O-]),$(C(=O)[C,c,O&D2])])', '1', '2', 'EXCLUDE', '1', '0'],
      ['biotin', '[CH2]-[CH]1-[S&v2]-[CH2]-[CH]2-[NH]-C(=O)-[NH]-[CH]12', '1', '2', 'EXCLUDE', '0', '1'],
      ['bis_activated_aryl_ester', 'O=[C,S]Oc1aaa([$(S(=O)(=O)),$(C(F)(F)(F)),$(C#N),$(N(=O)(=O)),$([N+](=O)[O-]),$(C(=O)O),$(C(=O)N)])aa([$(S(=O)(=O)),$(C(F)(F)(F)),$(C#N),$(N(=O)(=O)),$([N+](=O)[O-]),$(C(=O)O),$(C(=O)N)])1', '1', '2', 'EXCLUDE', '0', '0'],
      ['bis_picolylamines', '[nv3X2]c([c,s,n])[CX4][NX3]([H,C])[CX4]c([c,s,n])[nv3X2,nv3X3H1]', '1', '1', 'FLAG', '0', '0'],
      ['bis_sulfonyl_amide', 'S(=O)(=O)-[N;R0]-S(=O)(=O)', '1', '2', 'EXCLUDE', '0', '0'],
      ['boronic_acid', '[#6]-[#5](~[#8])~[#8]', '1', '0', 'ANNOTATION', '1', '0'],
      ['branched_polycyclic_aromatic', 'a1(a2aa(a3aaaaa3)aa(a4aaaaa4)a2)aaaaa1', '1', '1', 'FLAG', '0', '0'],
      ['C_S_double_bond_count', '[#6]=S', '1', '1', 'FLAG', '0', '0'],
      ['C3_linker_simple_count_3', '[#8,#7&v3,#16&v2]-[CH2]-[CH2]-[CH2]-[#8,#7&v3,#16&v2]', '3', '2', 'EXCLUDE', '0', '0'],
      ['carbanion', '[#6;-1;!$([#6;-1]~[*;+1])]', '1', '2', 'EXCLUDE', '1', '0'],
      ['carbodiimides', 'N=C=N', '1', '2', 'EXCLUDE', '1', '0'],
      ['carboxyclic_acid_halides', '[O,S]=C-[F,Cl,Br,I]', '1', '2', 'EXCLUDE', '0', '0'],
      ['carboxylic_acid_count_3', '[#6]-C(=O)[OH]', '3', '2', 'EXCLUDE', '0', '0'],
      ['catechole', 'c(-[O,N,S;!$(N[C,S]=O);H1,H2;R0])1c(-[O,N,S;!$(N[C,S]=O);H1,H2;R0])cccc1', '1', '2', 'EXCLUDE', '1', '0'],
      ['CF2_CF3_acetal', '[Cl,F,Br,I]C([Cl,F,Br,I])([Cl,F,Br,I])C([N,O,S])([N,O,S])C([Cl,F,Br,I])([Cl,F,Br,I])[Cl,F,Br,I]', '1', '2', 'EXCLUDE', '0', '0'],
      ['CF2_CF3_count_3', '[C;$(C(F)F)]', '3', '1', 'FLAG', '0', '0'],
      ['CF2_CF3_count_5', '[C;$(C(F)F)]', '5', '2', 'EXCLUDE', '0', '0'],
      ['CH_alkinyl_EWG', '[CH]#C-[$([#6]=[#8,#16]),$([#7,#15,#16]=[#8]),$(C#N),$(C(F)(F)F)]', '1', '0', 'ANNOTATION', '1', '0'],
      ['CH_alkinyl_HetAr', '[CH]#C-[c;$(c1n[a;!$(a=*)][a;!$(a=*)][a;!$(a=*)]n1),$(c1n[a;!$(a=*)]n[a;!$(a=*)][a;!$(a=*)]1),$(c1nn[a;!$(a=*)][a;!$(a=*)][a;!$(a=*)]1),$(c1c(-[$([#6,#7,#15,#16]~[#8;X1]),$(C#N),$(C=N)])[a;!$(a=*)][a;!$(a=*)][a;!$(a=*)]n1),$(c1n[a;!$(a=*)]c(-[$([#6,#7,#15,#16]~[#8;X1]),$(C#N),$(C=N)])[a;!$(a=*)][a;!$(a=*)]1),$(c1c(-[$([#6,#7,#15,#16]~[#8;X1]),$(C#N),$(C=N)])[a;!$(a=*)]n[a;!$(a=*)][a;!$(a=*)]1)]', '1', '0', 'ANNOTATION', '1', '0'],
      ['chelator_phenathrolin_like', '[n;R1;X2;!$([n;R1;X2]1:[a;R2](:[a;R2,R3]):[a;R2](:[a;R2,R3]):[n;R1;X2]aa1);!$([n;R1;X2]1:[a;R2](:[a;R2,R3]):[a;R2](:[a;R2,R3]):[n;R1;X2]a1);!$([n;R1;X2]1:[a;R2](:[a;R2,R3]):[a;R2](:[a;R2,R3]a1):[n;R1;X2]);!$([n;R1;X2]1:[a;R2](:[a;R2,R3]):[a;R2](:[a;R2,R3]aa1):[n;R1;X2])]:[a;R2](:[a;R2,R3]):[a;R2](:[a;R2,R3]):[n;R1;X2;!$([n;R1;X2]1:[a;R2](:[a;R2,R3]):[a;R2](:[a;R2,R3]a1):[n;R1;X2]);!$([n;R1;X2]1:[a;R2](:[a;R2,R3]):[a;R2](:[a;R2,R3]aa1):[n;R1;X2])]', '1', '2', 'EXCLUDE', '0', '0'],
      ['chlorates', 'Cl~O', '1', '2', 'EXCLUDE', '0', '0'],
      ['conjugated_alkenes', 'C=[C!R]-[C!R]=C', '1', '1', 'FLAG', '0', '0'],
      ['conjugated_dithioether', 'SC(=[!r])S', '1', '2', 'EXCLUDE', '0', '0'],
      ['crown_ether', '[$([O,S,#7;R1;!r3;!r4;!r5;!r6;!r7;!r8][CH,CH2;!r3;!r4;!r5;!r6;!r7;!r8][CH,CH2;!r3;!r4;!r5;!r6;!r7;!r8][O,S,#7;R1;!r3;!r4;!r5;!r6;!r7;!r8][CH,CH2;!r3;!r4;!r5;!r6;!r7;!r8][CH,CH2;!r3;!r4;!r5;!r6;!r7;!r8][O,S,#7;R1;!r3;!r4;!r5;!r6;!r7;!r8]),$([O,S,#7;R1;!r3;!r4;!r5;!r6;!r7;!r8][CH,CH2;!r3;!r4;!r5;!r6;!r7;!r8][CH,CH2;!r3;!r4;!r5;!r6;!r7;!r8][CH,CH2;!r3;!r4;!r5;!r6;!r7;!r8][O,S,#7;R1;!r3;!r4;!r5;!r6;!r7;!r8][CH,CH2;!r3;!r4;!r5;!r6;!r7;!r8][CH,CH2;!r3;!r4;!r5;!r6;!r7;!r8][CH,CH2;!r3;!r4;!r5;!r6;!r7;!r8][O,S,#7;R1;!r3;!r4;!r5;!r6;!r7;!r8]),$([O,S,#7;R1;!r3;!r4;!r5;!r6;!r7;!r8][CH,CH2;!r3;!r4;!r5;!r6;!r7;!r8][CH,CH2;!r3;!r4;!r5;!r6;!r7;!r8][O,S,#7;R1;!r3;!r4;!r5;!r6;!r7;!r8][CH,CH2;!r3;!r4;!r5;!r6;!r7;!r8][CH,CH2;!r3;!r4;!r5;!r6;!r7;!r8][CH,CH2;!r3;!r4;!r5;!r6;!r7;!r8][O,S,#7;R1;!r3;!r4;!r5;!r6;!r7;!r8])]', '1', '2', 'EXCLUDE', '0', '0'],
      ['cumarine', 'c1ccc2c(c1)ccc(=O)o2', '1', '0', 'ANNOTATION', '0', '0'],
      ['Cyanamides', 'N[CH2]C#N', '1', '0', 'ANNOTATION', '0', '0'],
      ['cyanate', '[#8,#7;!$([#7]=[#6](-[#7])-[#7]);!$([#7]-[#6](=[#7])-[#7]);!$([#7]:[#6](:[#7]):[#7])]-C#N', '1', '1', 'FLAG', '0', '0'],
      ['cyanhydrine', '[#8;H1,$([#8]-[#6,#16,#15]=[#8])]-[#6;X4]-[#6]#[#7]', '1', '1', 'FLAG', '0', '0'],
      ['cyano_imine', '[#7](-[#1])-[#7]=[#6](-[#6]#[#7])-[#6]=[!#6&!#1;!R]', '1', '2', 'EXCLUDE', '0', '0'],
      ['cyanopyridone_2', '[#6]-,:1(=,:[#6](-,:[#6](=[#8])-,:[#7]-,:[#6](=,:[#7]-,:1)-,:[!#6&!#1])-[#6]#[#7])-[#6]', '1', '2', 'EXCLUDE', '0', '0'],
      ['cyanopyridone_1', 'N#C-[#6]1~[#6;X3](~[#16&v2;$(S=C-[NH]),$([SH]-C=N),$([SH]-cn),$(S=c[nH])])~[#7]~[*;a,$(*(=*)-*)]~[*;a,$(*(=*)-*)]~[*;a,$(*(=*)-*)]~1', '1', '2', 'EXCLUDE', '0', '0'],
      ['cyclobutene', 'C1CC=C1', '1', '0', 'ANNOTATION', '0', '0'],
      ['cycloheximide_derivatives', 'O=C1CCCC(N1)=O', '1', '0', 'ANNOTATION', '0', '0'],
      ['cyclosporine', 'O=C(NCC(NC(C(C(CC=,-C)C)=,-[O,N])C(NCC(NCC(NCC(NCC(NCC(NCC(NCC(NC1)=O)=O)=O)=O)=O)=O)=O)=O)=O)CNC1=O', '1', '2', 'EXCLUDE', '0', '1'],
      ['cysteine hydroxamate', 'NC(C[S;D1])C([N;H1]([O;D1]))=O', '1', '2', 'EXCLUDE', '0', '0'],
      ['dhp_bis_amino_biscyano', '[#7](-[#1])(-[#1])-[#6]-1=[#6](-[#6]#[#7])-[#6](-[#1])(-[#6]:[#6])-[#6](=[#6](-[#7](-[#1])-[#1])-[#16]-1)-[#6]#[#7]', '1', '2', 'EXCLUDE', '0', '0'],
      ['di_oxalic_acid_imide', '[#8]=[#6]-,:[#6](=[#8])-,:[#7]-,:[#6](=[#8])-,:[#6]=[#8]', '1', '2', 'EXCLUDE', '0', '0'],
      ['diacetylene', 'C#CC#C', '1', '1', 'FLAG', '0', '0'],
      ['diarylamines', 'c([nv3X2])(c)[NX3H1!R]c([nv3X2])(c)', '1', '0', 'ANNOTATION', '0', '0'],
      ['diazo_acyl', 'O=C-N=!@N', '1', '2', 'EXCLUDE', '0', '0'],
      ['diazonium', '[#6]~[#7;X2]~[#7;X1]', '1', '2', 'EXCLUDE', '0', '0'],
      ['dicarbonimidic_diamide', '[O,S&v2,N&v3;R0]-[C;X3;R0](=[O,S&v2,N&v3;R0])-[O,S&v2,N&v3;R0]-,=[C;X3;R0](=,-[O,S&v2,N&v3;R0])-[O,S&v2,N&v3;R0]', '1', '1', 'FLAG', '0', '0'],
      ['dicarbonyl_sulfonamide', '[$(N(-C(=O))(-C(=O))(-S(=O))),$(n([#6](=O))([#6](=O))([#16](=O)))]', '1', '1', 'FLAG', '0', '0'],
      ['dicyano_vinyl', '[#6]=,:[#6](C#N)-,:[#6]=,:[#6]C#N', '1', '2', 'EXCLUDE', '1', '0'],
      ['diene_thione', '[#16]=[#6]-1-[#6]=,:[#6]-[!#6&!#1]-[#6]=,:[#6]-1', '1', '2', 'EXCLUDE', '0', '0'],
      ['diimino_dihydro_pyrrol_ol', '[#7](-[#6](-[#8])=[#6]1)-[#6](=[#7])-[#6]1=[#7]', '1', '1', 'FLAG', '0', '0'],
      ['diketene_acetals', '[!#6]~[#6](~[!#6])=[#6;!$([#6]1=[#6]-[#7,#8,#16&v2]~[#7,#8,#16&v2,#6&X3]~[#7,#8,#16&v2]1)](~[!#6])~[!#6]', '1', '2', 'EXCLUDE', '0', '0'],
      ['diketone_1_2', '[#8,#7v3]=!@[#6;$([#6](-[#6])-[#6]),$([#6;H1]=[#7]);!$([#6]1(=O)-,:[#6](=O)-,:[#6;X3]=,:[#6;X3]-,:[#6;X3]=,:[#6;X3]-,:1);!$([#6]1(=O)-[#6](=O)-[#6]=,:[#6]1)]~[#6;$([#6](-[#6])-[#6]),$([#6;H1]=[#7]);!$([#6]1(=O)-,:[#6](=O)-,:[#6;X3]=,:[#6;X3]-,:[#6;X3]=,:[#6;X3]-,:1);!$([#6]1(=O)-[#6](=O)-[#6]=,:[#6]1)]=!@[#8,#7v3]', '1', '1', 'FLAG', '1', '0'],
      ['dithiole_2_thione_1', 'S1SC=CC1=S', '1', '2', 'EXCLUDE', '0', '0'],
      ['dithiole_2_thione_2', 'S1C=CSC1=S', '1', '2', 'EXCLUDE', '0', '0'],
      ['double_michael_acceptor', '[CH2]=C(-[$([#6]=[#8,#16]),$([#7,#15,#16]=[#8]),$(C#N),$(C(F)(F)F)])-[$([#6]=[#8,#16]),$([#7,#15,#16]=[#8]),$(C#N),$(C(F)(F)F)]', '1', '2', 'EXCLUDE', '1', '0'],
      ['dye_1', 'c12cccc(C(=O)N(-&!@C)C(=O)3)c2c3ccc1', '1', '2', 'EXCLUDE', '0', '0'],
      ['dye_2', 'N=C1[#6]:,=[#6]C(=[C,N])[#6]:,=[#6]1', '1', '2', 'EXCLUDE', '0', '0'],
      ['dyes_like_NN_doublebond ', '[#6][N;R0]=[N;R0][#6]', '1', '0', 'ANNOTATION', '0', '0'],
      ['element_P_count_2', '[#15]', '2', '2', 'EXCLUDE', '0', '0'],
      ['element_S_count_2', '[#16]', '2', '0', 'ANNOTATION', '0', '0'],
      ['elements_forbidden', '[!#1;!#6;!#7;!#8;!#9;!#15;!#16;!#17;!#35;!#5;!#14;!#53;!#34]', '1', '2', 'EXCLUDE', '0', '0'],
      ['elements_penalized', '[!#1;!#6;!#7;!#8;!#9;!#15;!#16;!#17;!#35]', '1', '1', 'FLAG', '0', '0'],
      ['en_barbiturates', 'C=!@[#6]1~[#6;X3](~[#8;$(O=C),$(O-C=N),$(O-cn)])~[#7]~[#6;X3](~[#8,#16&v2;$(A=C),$(A-C=N),$(A-cn)])~[#7]~[#6;X3](~[#8;$(O=C),$(O-C=N),$(O-cn)])1', '1', '1', 'FLAG', '1', '0'],
      ['enamine_aliphatic', '[C;!$(C-[#6;X3,X2]);!$(C-[#7,#8,#16])]=!@[C;!$(C-[#6;X3,X2]);!$(C-[#8,#16]);!$(C(-[#7])[#7])]-N', '1', '1', 'FLAG', '0', '0'],
      ['ene_five_het', '[#6]-1(=[#6])-[#6](-[#7]=[#6]-[#16]-1)=[#8]', '1', '2', 'EXCLUDE', '0', '0'],
      ['ene_five_membered_one', 'c:1-2:c(:c:c:c:c:1)-[#6](=[#8])-[#6](=[#6])-[#6]-2=[#8]', '1', '2', 'EXCLUDE', '0', '0'],
      ['ene_one_ene', '[#6]=!@[#6](-[!#1])-@[#6](=!@[!#6&!#1])-@[#6](=!@[#6])-[!#1]', '1', '2', 'EXCLUDE', '0', '0'],
      ['ene_one_halogen', '[#6]-[#6]=[#6](-[F,Cl,Br,I])-[#6](=[#8])-[#6]', '1', '2', 'EXCLUDE', '0', '0'],
      ['enol_ester', '[#6](=O)-O-[#6]=[#6;$([#6]-C#N),$([#6]-[#6]=O),$([#6]-S=O)]', '1', '2', 'EXCLUDE', '1', '0'],
      ['enolether_enolester', '[C;!$([#6]1=[#6]-[#6,#7&v3]=,:[#6,#7&v3]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-1);!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-[#6,#7&v3]=,:[#6,#7&v3]-1);!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#6,#7&v3]=,:[#6,#7&v3]-[#8,#7&v3,#16&v2]-1);!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-[#8,#7&v3,#16&v2]-1);!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-[#6](=[#8,#7&v3,#16&v2])-[#8,#7&v3,#16&v2]-1);!$([#6]1=[#6]-[#8]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-1)]=[C;!$([#6]1=[#6]-[#6,#7&v3]=,:[#6,#7&v3]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-1);!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-[#6,#7&v3]=,:[#6,#7&v3]-1);!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#6,#7&v3]=,:[#6,#7&v3]-[#8,#7&v3,#16&v2]-1);!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-[#8,#7&v3,#16&v2]-1);!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-[#6](=[#8,#7&v3,#16&v2])-[#8,#7&v3,#16&v2]-1);!$([#6]1=[#6]-[#8]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-1)]-O-[#6]', '1', '1', 'FLAG', '0', '0'],
      ['enyne', 'C=!@CC#C', '1', '0', 'ANNOTATION', '0', '0'],
      ['epoxide_terminal', 'C1O[C;H2]1', '1', '1', 'FLAG', '1', '0'],
      ['ergot_alkoloid', 'c12c3cccc1ncc2CC4NC[#6]~[#6]-,=C43', '1', '2', 'EXCLUDE', '0', '1'],
      ['ester_count_3', '[#6]-[O]-!@C(=O)-[#6]', '3', '1', 'FLAG', '0', '0'],
      ['ester_count_5', '[#6]-[O]-!@C(=O)-[#6]', '5', '2', 'EXCLUDE', '0', '0'],
      ['ether_bond_count_5', '[C;X4]-O-[C;X4]', '5', '1', 'FLAG', '0', '0'],
      ['farnesyl_geranyl', '[CH3]-[CH,$(C=C),$(C-[OH])](-[CH3])=,-[CH2,CH&X3,$([CH]-[OH])]-[CH2]-[CH2]-[CH,$(C=C),$(C-[OH])](-[CH3])=,-[CH2,CH&X3,$([CH]-[OH])]-[CH2]-[CH2]-[CH,$(C=C),$(C-[OH])](-[CH3])=,-[CH2,CH&X3,$([CH]-[OH])]-[CH2]', '1', '2', 'EXCLUDE', '0', '1'],
      ['fatty_acid', 'C~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@C(=O)-[O,N!$(N-a)]', '1', '2', 'EXCLUDE', '0', '1'],
      ['flavonoid', 'c12-,:[#6](=O)-,:[#6]~[#6](-c3ccccc3)-,:[#8]-,:c1cccc2', '1', '0', 'ANNOTATION', '0', '0'],
      ['fluorene_fmoc', '[C;X4]1-c2ccccc2-c3ccccc3-1', '1', '0', 'ANNOTATION', '0', '0'],
      ['fluorescein', '[#6;$(C14(ccC(=O)O4)c2ccc(-[O,S,N])cc2Oc3ccccc31),$(C1(ccC(=O)O)=C2C=CC(=[O,N,S])C=C2Oc3ccccc31),$(c1(-ccC(=O)O)c2ccc(=[O,N,S])cc2oc3ccccc31)]1(ccC(=O)O)~[#6]2~[#6]~[#6]~[#6]~[#6]~[#6]2~[#8]~c3ccccc31', '1', '2', 'EXCLUDE', '0', '1'],
      ['fluoro_methyl_ketone', '[#6]-C(=O)-[CH2]-F', '1', '1', 'FLAG', '1', '0'],
      ['four_nitriles', 'C#N.C#N.C#N.C#N', '1', '2', 'EXCLUDE', '0', '0'],
      ['furane_pyrrole_thiophene_count_2', '[o,n,s]1[c;R1,$(c-A)][c;R1,$(c-A)][c;R1,$(c-A)][c;R1,$(c-A)]1', '2', '0', 'ANNOTATION', '0', '0'],
      ['fused_cyclopentene_quinolines', 'C1=CC2c3ccccc3NCC2C1', '1', '1', 'FLAG', '0', '0'],
      ['glycoside_01', '[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)](-O1)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CH]1-O-[CH2][CH](-O2)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CH]2-O', '1', '2', 'EXCLUDE', '0', '1'],
      ['glycoside_02', '[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)](-O1)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CH]1-O-[CH](-[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)]-O2)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CH]2-O', '1', '2', 'EXCLUDE', '0', '1'],
      ['glycoside_03', '[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)](-O1)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CH]1-O-[CH](-[CX4;$([CH]-O),$([CH]-[N!H0]),H2]-[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)]-O2)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CH]2-O', '1', '2', 'EXCLUDE', '0', '1'],
      ['glycoside_04', '[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)](-O1)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CH]1-O-[CH](-[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2]-[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)]-O2)[CH]2-O', '1', '2', 'EXCLUDE', '0', '1'],
      ['glycoside_05', '[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)](-O1)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CH]1-O-[CH](-O2)-[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2]-[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)]-2', '1', '2', 'EXCLUDE', '0', '1'],
      ['glycoside_06', '[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)](-O1)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;H1,$([C]-[CH3]),$([C]-[CH2]-O),$(CC(=O)-O)]1-O-[CH2][CH](-O2)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CH]2-O', '1', '2', 'EXCLUDE', '0', '1'],
      ['glycoside_07', '[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)](-O1)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;H1,$([C]-[CH3]),$([C]-[CH2]-O),$(CC(=O)-O)]1-O-[CH](-[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)]-O2)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CH]2-O', '1', '2', 'EXCLUDE', '0', '1'],
      ['glycoside_08', '[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)](-O1)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;H1,$([C]-[CH3]),$([C]-[CH2]-O),$(CC(=O)-O)]1-O-[CH](-[CX4;$([CH]-O),$([CH]-[N!H0]),H2]-[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)]-O2)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CH]2-O', '1', '2', 'EXCLUDE', '0', '1'],
      ['glycoside_09', '[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)](-O1)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;H1,$([C]-[CH3]),$([C]-[CH2]-O),$(CC(=O)-O)]1-O-[CH](-[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2]-[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)]-O2)[CH]2-O', '1', '2', 'EXCLUDE', '0', '1'],
      ['glycoside_10', '[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)](-O1)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;H1,$([C]-[CH3]),$([C]-[CH2]-O),$(CC(=O)-O)]1-O-[CH](-O2)-[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2]-[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)]-2', '1', '2', 'EXCLUDE', '0', '1'],
      ['glycoside_11', '[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)](-O1)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CH]1-O-[CH2][CH](-O2)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;H1,$([C]-[CH3]),$([C]-[CH2]-O),$(CC(=O)-O)](-O)-2', '1', '2', 'EXCLUDE', '0', '1'],
      ['glycoside_12', '[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)](-O1)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CH]1-O-[CH](-[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]C(=O)-O)]-O2)-[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;H1,$([C]-[CH3]),$([C]-[CH2]-O),$(CC(=O)-O)](-O)-2', '1', '2', 'EXCLUDE', '0', '1'],
      ['glycoside_13', '[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)](-O1)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CH]1-O-[CH](-[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]C(=O)-O)]-O2)-[CX4;H1,$([C]-[CH3]),$([C]-[CH2]-O),$(CC(=O)-O)](-O)-2', '1', '2', 'EXCLUDE', '0', '1'],
      ['glycoside_14', '[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)](-O1)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CH]1-O-[CH2]C(-O2)(-O)-[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]C(=O)-O)]-2', '1', '2', 'EXCLUDE', '0', '1'],
      ['glycoside_15', '[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)](-O1)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;H1,$([C]-[CH3]),$([C]-[CH2]-O),$(CC(=O)-O)]1-O-[CH2][CH](-O2)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;H1,$([C]-[CH3]),$([C]-[CH2]-O),$(CC(=O)-O)](-O)-2', '1', '2', 'EXCLUDE', '0', '1'],
      ['glycoside_16', '[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)](-O1)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;H1,$([C]-[CH3]),$([C]-[CH2]-O),$(CC(=O)-O)]1-O-[CH](-[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]C(=O)-O)]-O2)-[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;H1,$([C]-[CH3]),$([C]-[CH2]-O),$(CC(=O)-O)](-O)-2', '1', '2', 'EXCLUDE', '0', '1'],
      ['glycoside_17', '[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)](-O1)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;H1,$([C]-[CH3]),$([C]-[CH2]-O),$(CC(=O)-O)]1-O-[CH](-[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]C(=O)-O)]-O2)-[CX4;H1,$([C]-[CH3]),$([C]-[CH2]-O),$(CC(=O)-O)](-O)-2', '1', '2', 'EXCLUDE', '0', '1'],
      ['glycoside_18', '[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)](-O1)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;H1,$([C]-[CH3]),$([C]-[CH2]-O),$(CC(=O)-O)]1-O-[CX4;H1,$([C]-[CH3]),$([C]-[CH2]-O),$(CC(=O)-O)](-O2)-[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2]-[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]C(=O)-O)]-2', '1', '2', 'EXCLUDE', '0', '1'],
      ['glycoside_19', '[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]-C(=O)-O)](-O1)[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;H1,$([C]-[CH3]),$([C]-[CH2]-O),$(CC(=O)-O)]1-O-[CH2]C(-O2)(-O)-[CX4;$([CH]-O),$([CH]-[N!H0]),H2][CX4;$([CH]-O),$([CH]-[N!H0]),H2]-[CX4;H2,$([CH]-[CH3]),$([CH]-[CH2]-O),$([CH]C(=O)-O)]-2', '1', '2', 'EXCLUDE', '0', '1'],
      ['grignard', 'C[Mg][F,Cl,Br,I]', '1', '2', 'EXCLUDE', '0', '0'],
      ['guanidines', 'N=C(N)N', '1', '0', 'ANNOTATION', '0', '0'],
      ['gylcerol_long_chain_ether', 'C~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@O-[CH2]-[CH](-O)-[CH2]-O', '1', '2', 'EXCLUDE', '0', '1'],
      ['halo_alkynes', 'C#C-[Cl,Br,I]', '1', '2', 'EXCLUDE', '0', '0'],
      ['halo_ether', '[Cl,Br,I][CX4][CX4][$([O,S,N]*),Cl,Br,I]', '1', '2', 'EXCLUDE', '0', '0'],
      ['halo_olefin_bis_EWG', 'C([Cl,Br,I,$(O(S(=O)(=O)))])=C([$(S(=O)(=O)),$(C(F)(F)(F)),$(C#N),$(N(=O)(=O)),$([N+](=O)[O-]),$(C=O)])([$(S(=O)(=O)),$(C(F)(F)(F)),$(C#N),$(N(=O)(=O)),$([N+](=O)[O-]),$(C=O)])', '1', '2', 'EXCLUDE', '1', '0'],
      ['halo_phenoxy_ketone', '[#6]-[#6](-[#6]-[#8,#16]-[c]1:[c](-[#17,#9]):[c]:[c]:[c]:[c]1-[#17,#9])=[#8]', '1', '1', 'FLAG', '1', '0'],
      ['halogen_aliphatic_count_3', '[C;!$(C(Cl)(Cl)Cl);!$(C(F)F)]-[F,Cl,Br,I]', '3', '1', 'FLAG', '0', '0'],
      ['halogen_alkyl', '[Cl,Br,I]-[CX4;!$(C([F,Cl,Br,I])[F,Cl,Br,I])]', '1', '1', 'FLAG', '1', '0'],
      ['halogen_alkyl_count_2', '[Cl,Br,I]-[CX4;!$(C([F,Cl,Br,I])[F,Cl,Br,I])]', '2', '2', 'EXCLUDE', '1', '0'],
      ['halogen_aromatic_count_3', 'c-[F,Cl,Br,I]', '3', '0', 'ANNOTATION', '0', '0'],
      ['halogen_heteroatom_bond', '[#8,#7,#15,#16,#14,#5]-[F!$(F-[#14])!$(F-S(=O)(=O)-[#6])!$(F-S(F)(F)),Cl,Br,I]', '1', '2', 'EXCLUDE', '0', '0'],
      ['halogen_hypervalent', '*~[F,Cl,Br,I]~*', '1', '2', 'EXCLUDE', '0', '0'],
      ['halogen_vinyl', 'C=!@C-[F,Cl,Br,I]', '1', '1', 'FLAG', '0', '0'],
      ['halogenated_hetero_aromates', '[F,Cl,Br,I]-[c;$(c1n[a;!$(a=*)][a;!$(a=*)][a;!$(a=*)]n1),$(c1n[a;!$(a=*)]n[a;!$(a=*)][a;!$(a=*)]1),$(c1nn[a;!$(a=*)][a;!$(a=*)][a;!$(a=*)]1),$(c1c(-[$([#6,#7,#15,#16]~[#8;X1]),$(C#N),$(C=N)])[a;!$(a=*)][a;!$(a=*)][a;!$(a=*)]n1),$(c1n[a;!$(a=*)]c(-[$([#6,#7,#15,#16]~[#8;X1]),$(C#N),$(C=N)])[a;!$(a=*)][a;!$(a=*)]1),$(c1c(-[$([#6,#7,#15,#16]~[#8;X1]),$(C#N),$(C=N)])[a;!$(a=*)]n[a;!$(a=*)][a;!$(a=*)]1)]', '1', '0', 'ANNOTATION', '1', '0'],
      ['hemiacetal', '[#6]-O[CH1](-[#6])[OH1]', '1', '0', 'ANNOTATION', '0', '0'],
      ['hetero_imides', '[!#6]-[CH2]-N1C(=O)CCC(=O)1', '1', '2', 'EXCLUDE', '0', '0'],
      ['heteroarylsulfides', '[SX2]-[#6R1]2=,:[#7R1]-,:[#6R1]=,:[#6R1]-,:[#7R2]3-,:[#6R1](=O)-,:[#7R1]-,:[#7R1]=,:[#6R2]23', '1', '0', 'ANNOTATION', '0', '0'],
      ['heterocycle_exo_double_bond_1', '[#6]=!@[#6]1~[#6]=,:[#6]-,:[!#6]~[#6;X3](~[!#6])-,:1', '1', '0', 'ANNOTATION', '1', '0'],
      ['heterocycle_exo_double_bond_2', 'C=!@[#6]1~[#6;X3](~[#8;$(O=C),$(O-C=N),$(O-cn)])~[#7]-[#7]~[#6;X3](~[#8;$(O=C),$(O-C=N),$(O-cn)])~1', '1', '1', 'FLAG', '1', '0'],
      ['heterocycle_exo_double_bond_3', 'C=!@[#6]1~[#6;X3](~[#7,#8,#16v2])~[#7;X2]~[#6;X3;H1,$([#6]-[#6])]~[#8,#7&v3,#16v2]~1', '1', '1', 'FLAG', '1', '0'],
      ['heterocycle_exo_double_bond_4', 'C=!@[#6]1~[#6;X3](~[#16&v2])~[#7]~[#7]=,:[#6]~1', '1', '1', 'FLAG', '1', '0'],
      ['heterocycle_exo_double_bond_5', '[#6]=!@[#6]1~[#6;X3](~[#8;$([#8]=[#6]),$([#8]-[#6]=,:[#7])])~[!#6]-,:[#7;X2]=,:[#6]-,:1', '1', '0', 'ANNOTATION', '1', '0'],
      ['HOBT_ester', 'O=C(-[!N])O[$(nnn),$([#7]-[#7]=[#7])]', '1', '2', 'EXCLUDE', '1', '0'],
      ['hydantoin', 'C1NC(=O)NC(=O)1', '1', '0', 'ANNOTATION', '0', '0'],
      ['hydrazine', 'NN', '1', '0', 'ANNOTATION', '0', '0'],
      ['hydrazine_1_2_diacyl_acyclic', 'O=C-!@N-!@N-!@C=O', '1', '0', 'ANNOTATION', '0', '0'],
      ['hydrazine_aldehyde', '[CH1;R0]=[N;R0][N;R0]', '1', '1', 'FLAG', '0', '0'],
      ['hydrazine_ketone', '[CH0]=[N;R0][N;R0]', '1', '0', 'ANNOTATION', '0', '0'],
      ['hydrazothiourea', 'N=NC(=S)N', '1', '2', 'EXCLUDE', '0', '0'],
      ['hydroquinone', 'c(-[O,N,S;!$(N[C,S]=O);H1,H2;R0])1ccc(-[O,N,S;!$(N[C,S]=O);H1,H2;R0])cc1', '1', '2', 'EXCLUDE', '0', '0'],
      ['hydroxamic_acid', 'C(=O)N[OH]', '1', '1', 'FLAG', '0', '0'],
      ['hydroxy_methyl_amine', '[#7]-[C;H2]-[O;H]', '1', '2', 'EXCLUDE', '0', '0'],
      ['hydroxyl_amine_ester', '[#7]O[#6,#16]=O', '2', '2', 'EXCLUDE', '0', '0'],
      ['hydroxyl_count_6', '[#6;!$([#6]=[!#6])]-[OH]', '6', '2', 'EXCLUDE', '0', '0'],
      ['hypofluorous_sulfinic_anhydride_FOSO', 'O=S(*)OF', '1', '2', 'EXCLUDE', '0', '0'],
      ['imidazol_2_halogenated', '[F,Cl,Br,I]-[#6;$(c1[n;X2]aa[a;!c]1),$(C1=N[#7]-,:[#6](=,:[#8,#7&v3,#16&v2])-,:[#7&v3,#16&v2,#8]-1),$(C1=N-[#8,#7&v3,#16&v2]-,:[#8,#7&v3,#16&v2]-,:[#6]1=,:[#8,#7&v3,#16&v2]),$(C1=N-[#6](=,:[#8,#7&v3,#16&v2])-,:[#8,#7&v3,#16&v2]-,:[#8,#7&v3,#16&v2]-1)]=,:[#7;X2]', '1', '1', 'FLAG', '0', '0'],
      ['imidic_anhydrides', 'O=[#6]-,:[#8]-,:[#6]=,:[#7&X2,+1]', '1', '2', 'EXCLUDE', '1', '0'],
      ['imine_nonterminal', '[#6,#8,#16]-C(=[NH1])[#6,#8,#16]', '1', '1', 'FLAG', '0', '0'],
      ['imine_terminal', '[#6,#8,#16]-[CH1]=[NH1]', '1', '2', 'EXCLUDE', '1', '0'],
      ['imine_halogenated', '[F,Cl,Br,I]-[C;!$(C1=N[#7]-,:[#6](=,:[#8,#7&v3,#16&v2])-,:[#7&v3,#6&X3]=,:[#7&v3,#6&X3]-1);!$(C1=N[#7]-,:[#6](=,:[#8,#7&v3,#16&v2])-,:[#7&v3,#16&v2,#8]-1);!$(C1=N-[#8,#7&v3,#16&v2]-,:[#8,#7&v3,#16&v2]-,:[#6]1=,:[#8,#7&v3,#16&v2]);!$(C1=N-[#6](=,:[#8,#7&v3,#16&v2])-,:[#8,#7&v3,#16&v2]-,:[#8,#7&v3,#16&v2]-1);!$(C1=N-[#6](=,:[#8,#7&v3,#16&v2])-,:[#8,#7&v3,#16&v2]-,:[#7&v3,#6&X3]=,:[#7&v3,#6&X3]-1);!$(C1=N-[#6](=,:[#8,#7&v3,#16&v2])-,:[#7&v3,#6&X3]=,:[#7&v3,#6&X3]-,:[#8,#7&v3,#16&v2]-1);!$(C1=N-[#6]=,:[#6]-[#8,#7&v3,#16&v2]-,:[#6]1=,:[#8,#7&v3,#16&v2])]=N', '1', '2', 'EXCLUDE', '1', '0'],
      ['imine_one_five_membered', '[#6]-1=[!#1]-[!#6&!#1]-[#6](-[#6]-1=[!#6&!#1;!R])=[#8]', '1', '0', 'ANNOTATION', '0', '0'],
      ['imine_one_isatin', '[#8]=[#6]-2-[#6](=!@[#7]-[#7])-c:1:c:c:c:c:c:1-[#7]-2', '1', '1', 'FLAG', '0', '0'],
      ['imine_one_six_membered', '[#6]-1(-[#6](=[#8])-[#7]-[#6](=[#8])-[#7]-[#6]-1=[#8])=[#7]', '1', '2', 'EXCLUDE', '0', '0'],
      ['indol_3yl_alkyl', '[n;!H0,$(n-[#6;!H0;!H1])]:1(c(c(c:2:c:1:c:c:c:c:2-[#1])-[#6;X4]-[#1])-[$([#6](-[#1])-[#1]),$([#6]=,:[!#6&!#1]),$([#6](-[#1])-[#7]),$([#6](-[#1])(-[#6](-[#1])-[#1])-[#6](-[#1])(-[#1])-[#7](-[#1])-[#6](-[#1])-[#1])])', '1', '0', 'ANNOTATION', '0', '0'],
      ['iso_flavonoid', 'c12-,:[#6](=O)-,:[#6](-c3ccccc3)~[#6]-,:[#8]-,:c1cccc2', '1', '0', 'ANNOTATION', '0', '0'],
      ['isocyanate', '[#7]=,#[#6;$([#6](#[#7+])-[#8-,#16-]),$([#6](=[#7])=[#8,#16])]=,-[#8,#16;X1]', '1', '2', 'EXCLUDE', '1', '0'],
      ['isontrile', '[#6;-1;X1]#[#7;+1;X2]', '1', '2', 'EXCLUDE', '1', '0'],
      ['isotope_C13', '[13#6]', '1', '2', 'EXCLUDE', '0', '1'],
      ['isotope_C14', '[14#6]', '1', '2', 'EXCLUDE', '0', '1'],
      ['isotope_I125', '[125#53]', '1', '2', 'EXCLUDE', '0', '1'],
      ['isotope_N15', '[15#7]', '1', '2', 'EXCLUDE', '0', '1'],
      ['isotope_N16', '[16#7]', '1', '2', 'EXCLUDE', '0', '1'],
      ['isotope_O17', '[17#8]', '1', '2', 'EXCLUDE', '0', '1'],
      ['isotope_O18', '[18#8]', '1', '2', 'EXCLUDE', '0', '1'],
      ['isotope_S35', '[35#16]', '1', '2', 'EXCLUDE', '0', '1'],
      ['isotope_T', '[3#1]', '1', '2', 'EXCLUDE', '0', '1'],
      ['ketals _or_acetals', '[C;X4,H]OC([C;X4,H])(O[C;X4,H])[C;X4]', '1', '0', 'ANNOTATION', '0', '0'],
      ['ketene', 'C=C=O', '1', '2', 'EXCLUDE', '1', '0'],
      ['ketimines_acyclic', '[#6]-[C!$(C1-,:[#6&X3,#7&v3]=,:[#6&X3,#7&v3]-,:[#7&v3,#16&v2,#8]-,:[#6&X3,#7&v3]=,:[#6&X3,#7&v3]-,:1);!$(C1-,:[#6&X3,#7&v3]=,:[#6&X3,#7&v3]-,:[#6&X3,#7&v3]=,:[#6&X3,#7&v3]-,:[#7&v3,#16&v2,#8]-,:1);!$(C1-,:[#7&v3,#16&v2,#8]-C(=[#7&v3,#16&v2,#8])-,:[#6&X3,#7&v3]=,:[#6&X3,#7&v3]-,:[#7&v3,#16&v2,#8]-,:1);!$(C1-,:[#7&v3,#16&v2,#8]-C(=[#7&v3,#16&v2,#8])-,:[#7&v3,#16&v2,#8]-,:[#6&X3,#7&v3]=,:[#6&X3,#7&v3]-,:1);!$(C1-,:[#7&v3,#16&v2,#8]-C(=[#7&v3,#16&v2,#8])-,:[#7&v3,#16&v2,#8]-,:[#7&v3,#16&v2,#8]-C(=[#7&v3,#16&v2,#8])-,:1)](-[#6])=!@[N;!$(N~[#7,#8])]', '1', '1', 'FLAG', '0', '0'],
      ['keto_aldehyde_or_acetal', 'C(=O)-[CH;$(C=O),$(C(-[OH])-[OH])]', '1', '2', 'EXCLUDE', '0', '0'],
      ['keto_keto_beta', 'c:1-2:c(:c:c:c:c:1)-[#6](=[#8])-[#6;X4]-[#6]-2=[#8]', '1', '0', 'ANNOTATION', '0', '0'],
      ['labile_ester_2', 'O=COn1cncc1', '1', '2', 'EXCLUDE', '0', '0'],
      ['lawessons_reagent_and_derivatives', 'P(=S)(S)S', '1', '2', 'EXCLUDE', '0', '0'],
      ['lipid_phospho_1', 'C~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@C-OP(=O)(-[O-,OH])-O-[CH2]-[CH2]-N', '1', '2', 'EXCLUDE', '0', '1'],
      ['lipid_phospho_2', 'C~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@C-O-[CH2]-!@[CH](-O)-!@[CH2]-OP(=O)(-[O-,OH])-O-[CH2]-[CH2]-N', '1', '2', 'EXCLUDE', '0', '1'],
      ['long_chain_aliphatic', '[CH2;R0]-[CH2;R0]-[CH2;R0]-[CH2;R0]-[CH2;R0]-[CH2;R0]-[CH2,CH3;R0]', '1', '1', 'FLAG', '0', '0'],
      ['long_chain_flexible_C', '*-!@[CH2,$([CH]-[CH3]),$([C](-[CH3])-[CH3]),NH&v3,$([N&v3]-[CH3]),O,S&v2]-!@[CH2,$([CH]-[CH3]),$([C](-[CH3])-[CH3]),NH&v3,$([N&v3]-[CH3]),O,S&v2]-!@[CH2,$([CH]-[CH3]),$([C](-[CH3])-[CH3]),NH&v3,$([N&v3]-[CH3]),O,S&v2]-!@[CH2,$([CH]-[CH3]),$([C](-[CH3])-[CH3]),NH&v3,$([N&v3]-[CH3]),O,S&v2]-!@[CH2,$([CH]-[CH3]),$([C](-[CH3])-[CH3]),NH&v3,$([N&v3]-[CH3]),O,S&v2]-!@[CH2,$([CH]-[CH3]),$([C](-[CH3])-[CH3]),NH&v3,$([N&v3]-[CH3]),O,S&v2]-!@*', '1', '0', 'ANNOTATION', '0', '0'],
      ['maleimides', 'O=C(N1)[C;H1]=[C;H1]C1=O', '1', '2', 'EXCLUDE', '1', '0'],
      ['mannich_base_phenolic', '[OH]-c1ccccc1-[C;X4;R0](-[N;v3])-c', '1', '2', 'EXCLUDE', '1', '0'],
      ['meldrums_acid_deriv', 'O=C1OC(C)(C)OC(C1)=O', '1', '0', 'ANNOTATION', '0', '0'],
      ['mercapto_thiochromenone', '[c]1:[c]2:[c](-[#6](=[#8])-[#6]=[#6](-[#16])-[#16]2):[c]:[c]:[c]1', '1', '2', 'EXCLUDE', '0', '0'],
      ['methyl_group_count_aromatic_ring', '[CH3]-[c;$(cc([CH3])c([CH3])c[CH3]),$(cc([CH3])c([CH3])cc[CH3]),$(cc([CH3])cc([CH3])c[CH3])]', '1', '2', 'EXCLUDE', '0', '0'],
      ['methylene_1_3_5_thiadiazines', '[#6]=[#6]1-[#16&v2]-[C;X4]-[#7&v3]-[C;X4]-[#7&v3]-1', '1', '2', 'EXCLUDE', '0', '0'],
      ['methylsulfanyl_thiopyranone', '[S&v2]-[#6]1-,:[#16&v2]-,:[#6]=,:[#6]-,:[#6](=[#8])-,:[#6]=,:1', '1', '1', 'FLAG', '1', '0'],
      ['michael acceptor_1', '[#6,#7]-&!@[#6](=&!@[CH])-&!@C(=O)-&!@[C,N,O,S]', '1', '0', 'ANNOTATION', '1', '0'],
      ['michael_acceptor_2', '[a;$(a1:[a;!$(a=*)]:[a;!$(a=*)]:[a;!$(a=*)]:[a;!$(a=*)]:[a;!$(a=*)]:1),$(a1:[a;!$(a=*)]:[a;!$(a=*)]:[a;!$(a=*)]:[a;!$(a=*)]:1)]-[C;!$(C~[#7,#8,#16,F,Cl,Br,I]);!$([#6]1=[#6]-[#6,#7&v3]=,:[#6,#7&v3]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-1);!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-[#6,#7&v3]=,:[#6,#7&v3]-1);!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#6,#7&v3]=,:[#6,#7&v3]-[#8,#7&v3,#16&v2]-1);!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-[#8,#7&v3,#16&v2]-1);!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-[#6](=[#8,#7&v3,#16&v2])-[#8,#7&v3,#16&v2]-1)]=[C;!$([#6]1=[#6]-[#6,#7&v3]=,:[#6,#7&v3]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-1);!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-[#6,#7&v3]=,:[#6,#7&v3]-1);!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#6,#7&v3]=,:[#6,#7&v3]-[#8,#7&v3,#16&v2]-1);!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-[#8,#7&v3,#16&v2]-1);!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-[#6](=[#8,#7&v3,#16&v2])-[#8,#7&v3,#16&v2]-1)](-[$([#6;H1]=[#8,#16]),$([#7,#15,#16]=[#8])])-[$([#6;H1]=[#8,#16]),$([#7,#15,#16]=[#8])]', '1', '2', 'EXCLUDE', '1', '0'],
      ['michael_acceptor_CH2_terminal', '[CH2]=[C!$(C(-[$([#6]=[#8,#16]),$([#7,#15,#16]=[#8]),$(C#N),$(C(F)(F)F)])-[$([#6]=[#8,#16]),$([#7,#15,#16]=[#8]),$(C#N),$(C(F)(F)F)])]-[$([#6]=[#8,#16]),$([#7,#15,#16]=[#8]),$(C#N),$(C(F)(F)F)]', '1', '0', 'ANNOTATION', '1', '0'],
      ['michael_acceptor_double_act', '[C;!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-[#6](=[#8,#7&v3,#16&v2])-[#8,#7&v3,#16&v2]-1);!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-[#8,#7&v3,#16&v2]-1);!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#6,#7&v3]=,:[#6,#7&v3]-[#8,#7&v3,#16&v2]-1);!$([#6]1=[#6]-[#6,#7&v3]=,:[#6,#7&v3]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-1)]=[C;!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-[#6](=[#8,#7&v3,#16&v2])-[#8,#7&v3,#16&v2]-1);!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-[#8,#7&v3,#16&v2]-1);!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#6,#7&v3]=,:[#6,#7&v3]-[#8,#7&v3,#16&v2]-1);!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-[#6,#7&v3]=,:[#6,#7&v3]-1);!$([#6]1=[#6]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-[#6,#7&v3]=,:[#6,#7&v3]-1);!$([#6]1=[#6]-[#6,#7&v3]=,:[#6,#7&v3]-[#6](=[#8,#7,#16&v2])-[#8,#7&v3,#16&v2]-1)](-[$([#6]=[#8,#16]),$([#7,#15,#16]=[#8]),$(C#N),$(C(F)(F)F)])-[$([#6]=[#8,#16]),$([#7,#15,#16]=[#8]),$(C#N),$(C(F)(F)F)]', '1', '0', 'ANNOTATION', '1', '0'],
      ['michael_acceptor_3', '[$(N#C-C#C[C,c]),$(C#C-[CH]=O),$(C(#C-C(=O)-[C,c]))] ', '1', '0', 'ANNOTATION', '1', '0'],
      ['N_acyl_123_triazole', '[#7;R1]1~[#7;R1]~[#7;R1](-C(=O))~[#6]~[#6]1', '1', '2', 'EXCLUDE', '1', '0'],
      ['N_acyl_134_triazole', '[#7]1~[#7]~[#6]~[#7](-C(=O)[!N])~[#6]1', '1', '2', 'EXCLUDE', '1', '0'],
      ['N_acyl_2_amino_5_mercapto_1_3_4_thiadiazole', 's1c(S)nnc1NC=O', '1', '1', 'FLAG', '0', '0'],
      ['N_amido_tetrazole', 'c1nnnn1C=O', '1', '1', 'FLAG', '1', '0'],
      ['N_hydroxyl _pyridine', 'n[OH]', '1', '0', 'ANNOTATION', '0', '0'],
      ['N_hydroxyl_imide_ester', 'O=C1-[#6]~[#6]-C(=O)N1-O-C=O', '1', '2', 'EXCLUDE', '1', '0'],
      ['N_mercapto_thioamide', '[#16&v2&R0]=,-[#6;$([#6](=[#16&v2])-[#7]-[#16&v2]),$([#6](-[#16&v2])=[#7]-[#16&v2]),$(c1nsaa1),$(c1nsaaa1)]~[#7]-,:[#16&v2]', '1', '2', 'EXCLUDE', '0', '0'],
      ['N_O_single_bond', '[#6]-[N;!$([N+](=O)-[O-]);!$([N](=O)=O);!$([N]-[#6]=O)]-[OX2]', '1', '0', 'ANNOTATION', '0', '0'],
      ['N_oxide_sp2', '[#7;+1;X3;!$([#7;+1](=[#8])-[#8;-1]);!$([#7;+1](#[#6])-[#8;-1])]-[#8;-1]', '1', '0', 'ANNOTATION', '0', '0'],
      ['N_oxide_sp2_count_2', '[#7;+1;X3;!$([#7;+1](=[#8])-[#8;-1]);!$([#7;+1](#[#6])-[#8;-1])]-[#8;-1]', '2', '2', 'EXCLUDE', '0', '0'],
      ['N_oxides', '[N;X4;$([N+]-[O-]),$(N(=O)([#6])([#6])-[#6])]', '1', '0', 'ANNOTATION', '0', '0'],
      ['NCCN_potential_chelating', '[$(c1[nv3X2][c,n][c,n,s][c,n]1),$(c2[nv3X2][c,n][c,n][c,n][c,n]2)]-[$(c1[nv3X2][c,n][c,n,s][c,n]1),$(c2[nv3X2][c,n][c,n][c,n][c,n]2)]', '1', '0', 'ANNOTATION', '0', '0'],
      ['negativly_charged_sulfur', '[S-]', '1', '2', 'EXCLUDE', '0', '0'],
      ['nitrate', '[#8]-[#7](~[#8;X1])~[#8;X1]', '1', '2', 'EXCLUDE', '0', '0'],
      ['nitrile_N_oxide', 'C#[N+]-[O-]', '1', '2', 'EXCLUDE', '0', '0'],
      ['nitro_count_1', '[#6]-[N;X3](~[O;X1])~[O;X1]', '1', '0', 'ANNOTATION', '0', '0'],
      ['nitro_count_2', '[#6]-[N;X3](~[O;X1])~[O;X1]', '2', '1', 'FLAG', '0', '0'],
      ['nitro_count_3', '[#6]-[N;X3](~[O;X1])~[O;X1]', '3', '2', 'EXCLUDE', '0', '0'],
      ['nitroalkane', 'C[N+](=O)[O-]', '1', '2', 'EXCLUDE', '0', '0'],
      ['nitrobenz_azadiazole', 'c1ccc(n[o,s]n2)c2c1[N+](=O)[O-]', '1', '1', 'FLAG', '0', '0'],
      ['nitrone', '[N+]([O-])(=C)-* ', '1', '2', 'EXCLUDE', '0', '0'],
      ['nitroso_simple', '[#7;X2;!$([#7]-[#7v3])]=[#8]', '1', '2', 'EXCLUDE', '0', '0'],
      ['NP_SP_PP_single_bond_acyclic', '[#16&v2,#15]-!@[#7&X3,#15&X3]', '1', '2', 'EXCLUDE', '0', '0'],
      ['nucleoside_1', '[O,S][C!R]C(-[CX4&R1,O]1)[CX4][CX4][CX4&R1]1-[#7;$([#7;R1]2-,:[#6;R1](=O)-,:[#7,R1]=,:[#6,R1](-[N&H2,N&H1,O&H1])-,:[#6,#7;R1]=,:[#6,#7;R1]-,:2),$([#7;R1]2-,:[#6;R1](=O)-,:[#7,R1;H1]-,:[#6,R1](=[N,O])-,:[#6,#7;R1]=,:[#6,#7;R1]-,:2),$([#7;R1]2-,:[#6;R1](-[OH])=,:[#7,R1]-,:[#6,R1](=[N,O])-,:[#6,#7;R1]=,:[#6,#7;R1]-,:2)]', '1', '2', 'EXCLUDE', '0', '1'],
      ['nucleoside_2', '[O,S][C!R]C(-[CX4&R1,O]1)[CX4][CX4][CX4&R1]1-[#7;$([#7]2-,:[#6]3=,:[#7,#6;R1]-,:[#7,#6;R1]=,:[#7]-,:[#6](-[NH2,NH,OH])=,:[#6]-,:3-,:[#7,#6;R1]=,:[#6,#7;R1]-,:2),$([#7]2-,:[#6]3-,:[#7,#6;R1]=,:[#7,#6;R1]-,:[#7;H1]-,:[#6](=[NH,O])-,:[#6]=,:3-,:[#7,#6;R1]=,:[#6,#7;R1]-,:2),$([#7]2-,:[#6]3-,:[#7,#6;R1]-,:[#6](=[O,NH])-,:[#7;H1]-,:[#6](=[NH,O])-,:[#6]=,:3-,:[#7,#6;R1]=,:[#6,#7;R1]-,:2),$([#7]2-,:[#6]3-,:[#7,#6;R1]-,:[#6](=[O,NH])-,:[#7]=,:[#6](-[NH2,NH,OH])-,:[#6]=,:3-,:[#7,#6;R1]=,:[#6,#7;R1]-,:2)]', '1', '2', 'EXCLUDE', '0', '1'],
      ['nucleoside_3', 'O=P1O[CX4&R1][CX4&R2](-[CX4&R1,O]2)[CX4&R2](-O1)[CX4&R1][CX4&R1]2-[#7;$([#7;R1]3-,:[#6;R1](=O)-,:[#7,R1]=,:[#6,R1](-[N&H2,N&H1,O&H1])-,:[#6,#7;R1]=,:[#6,#7;R1]-,:3),$([#7;R1]3-,:[#6;R1](=O)-,:[#7,R1;H1]-,:[#6,R1](=[N,O])-,:[#6,#7;R1]=,:[#6,#7;R1]-,:3),$([#7;R1]3-,:[#6;R1](-[OH])=,:[#7,R1]-,:[#6,R1](=[N,O])-,:[#6,#7;R1]=,:[#6,#7;R1]-,:3)]', '1', '2', 'EXCLUDE', '0', '1'],
      ['nucleoside_4', 'O=P1O[CX4&R1][CX4&R2](-[CX4&R1,O]2)[CX4&R2](-O1)[CX4&R1][CX4&R1]2-[#7;$([#7]3-,:[#6]4=,:[#7,#6;R1]-,:[#7,#6;R1]=,:[#7]-,:[#6](-[NH2,NH,OH])=,:[#6]-,:4-,:[#7,#6;R1]=,:[#6,#7;R1]-,:3),$([#7]3-,:[#6]4-,:[#7,#6;R1]=,:[#7,#6;R1]-,:[#7;H1]-,:[#6](=[NH,O])-,:[#6]=,:4-,:[#7,#6;R1]=,:[#6,#7;R1]-,:3),$([#7]3-,:[#6]4-,:[#7,#6;R1]-,:[#6](=[O,NH])-,:[#7;H1]-,:[#6](=[NH,O])-,:[#6]=,:4-,:[#7,#6;R1]=,:[#6,#7;R1]-,:3),$([#7]3-,:[#6]4-,:[#7,#6;R1]-,:[#6](=[O,NH])-,:[#7]=,:[#6](-[NH2,NH,OH])-,:[#6]=,:4-,:[#7,#6;R1]=,:[#6,#7;R1]-,:3)]', '1', '2', 'EXCLUDE', '0', '1'],
      ['nucleoside_5', '[O,S][C!R]C(-[CX4&R1,O][CX4&R1]1)[CX4&R1][CX4&R1][CX4&R1]1-[#7;$([#7;R1]2-,:[#6;R1](=O)-,:[#7,R1]=,:[#6,R1](-[N&H2,N&H1,O&H1])-,:[#6,#7;R1]=,:[#6,#7;R1]-,:2),$([#7;R1]2-,:[#6;R1](=O)-,:[#7,R1;H1]-,:[#6,R1](=[N,O])-,:[#6,#7;R1]=,:[#6,#7;R1]-,:2),$([#7;R1]2-,:[#6;R1](-[OH])=,:[#7,R1]-,:[#6,R1](=[N,O])-,:[#6,#7;R1]=,:[#6,#7;R1]-,:2)]', '1', '2', 'EXCLUDE', '0', '1'],
      ['nucleoside_6', '[O,S][C!R]C(-[CX4&R1,O][CX4&R1]1)[CX4&R1][CX4&R1][CX4&R1]1-[#7;$([#7]2-,:[#6]3=,:[#7,#6;R1]-,:[#7,#6;R1]=,:[#7]-,:[#6](-[NH2,NH,OH])=,:[#6]-,:3-,:[#7,#6;R1]=,:[#6,#7;R1]-,:2),$([#7]2-,:[#6]3-,:[#7,#6;R1]=,:[#7,#6;R1]-,:[#7;H1]-,:[#6](=[NH,O])-,:[#6]=,:3-,:[#7,#6;R1]=,:[#6,#7;R1]-,:2),$([#7]2-,:[#6]3-,:[#7,#6;R1]-,:[#6](=[O,NH])-,:[#7;H1]-,:[#6](=[NH,O])-,:[#6]=,:3-,:[#7,#6;R1]=,:[#6,#7;R1]-,:2),$([#7]2-,:[#6]3-,:[#7,#6;R1]-,:[#6](=[O,NH])-,:[#7]=,:[#6](-[NH2,NH,OH])-,:[#6]=,:3-,:[#7,#6;R1]=,:[#6,#7;R1]-,:2)]', '1', '2', 'EXCLUDE', '0', '1'],
      ['nucleoside_7', '[O,S][C!R][CX4;R1;r6,r7][OR1;r6,r7][CX4;R1;r6,r7;$(C1OCCCC1),$(C1OCC=CC1),$(C1OCCC=C1),$(C1OCCCCC1)]!@[#7;$([#7;R1]2-,:[#6;R1](=O)-,:[#7,R1]=,:[#6,R1](-[N&H2,N&H1,O&H1])-,:[#6,#7;R1]=,:[#6,#7;R1]-,:2),$([#7;R1]2-,:[#6;R1](=O)-,:[#7,R1;H1]-,:[#6,R1](=[N,O])-,:[#6,#7;R1]=,:[#6,#7;R1]-,:2),$([#7;R1]2-,:[#6;R1](-[OH])=,:[#7,R1]-,:[#6,R1](=[N,O])-,:[#6,#7;R1]=,:[#6,#7;R1]-,:2)]', '1', '2', 'EXCLUDE', '0', '1'],
      ['nucleoside_8', '[O,S][C!R][CX4;R1;r6,r7][OR1;r6,r7][CX4;R1;r6,r7;$(C1OCCCC1),$(C1OCC=CC1),$(C1OCCC=C1),$(C1OCCCCC1)]!@[#7;$([#7]2-,:[#6]3=,:[#7,#6;R1]-,:[#7,#6;R1]=,:[#7]-,:[#6](-[NH2,NH,OH])=,:[#6]-,:3-,:[#7,#6;R1]=,:[#6,#7;R1]-,:2),$([#7]2-,:[#6]3-,:[#7,#6;R1]=,:[#7,#6;R1]-,:[#7;H1]-,:[#6](=[NH,O])-,:[#6]=,:3-,:[#7,#6;R1]=,:[#6,#7;R1]-,:2),$([#7]2-,:[#6]3-,:[#7,#6;R1]-,:[#6](=[O,NH])-,:[#7;H1]-,:[#6](=[NH,O])-,:[#6]=,:3-,:[#7,#6;R1]=,:[#6,#7;R1]-,:2),$([#7]2-,:[#6]3-,:[#7,#6;R1]-,:[#6](=[O,NH])-,:[#7]=,:[#6](-[NH2,NH,OH])-,:[#6]=,:3-,:[#7,#6;R1]=,:[#6,#7;R1]-,:2)]', '1', '2', 'EXCLUDE', '0', '1'],
      ['organo_phospho_cyanide', '[#8]=[#15]-[#6]#[#7]', '1', '2', 'EXCLUDE', '1', '0'],
      ['ortho_di_cyano_aromate', 'N#CccC#N', '1', '2', 'EXCLUDE', '0', '0'],
      ['ortho_nitrophenyl_carbonyl', '[#6]1(-O-[C;!R](=[O,N;!R]))[#6]([$(N(=O)(=O)),$([N+](=O)[O-])])[#6][#6][#6][#6]1', '1', '2', 'EXCLUDE', '0', '0'],
      ['o-tertbutylphenol', 'c(C([C;H3])([C;H3])[C;H3])1c([OH1])c(C([C;H3])([C;H3])[C;H3])ccc1', '1', '2', 'EXCLUDE', '0', '0'],
      ['oxalic_acid_diamide_count', 'N-C(=O)-!@C(=O)-N', '1', '0', 'ANNOTATION', '0', '0'],
      ['oxaziridine', 'C1~[O,S]~N1', '1', '2', 'EXCLUDE', '0', '0'],
      ['oxepine', 'O1C=CC=CC=C1', '1', '2', 'EXCLUDE', '0', '0'],
      ['oxim', 'C=N[OH]', '1', '0', 'ANNOTATION', '0', '0'],
      ['oxim_ester', 'O=C-!@[O]-!@[N]=!@[#6]', '1', '1', 'FLAG', '0', '0'],
      ['oxobenzothiepine', 'C1(=O)C=CCSC=C1', '1', '2', 'EXCLUDE', '0', '0'],
      ['ozonide', '[O;$(O1OCOC1),$(O1OOCC1)]', '1', '2', 'EXCLUDE', '0', '0'],
      ['para_nitro_arylamines', 'O=[N+](-[O-])-caac-[$(N(C)C),$([NH]C),$([NH2])]', '1', '1', 'FLAG', '0', '0'],
      ['para_nitrophenyl_ester', '[#6]1(-O(-[C;!R](-[!N])(=[O,N;!R])))[#6][#6][#6]([$(N(=O)(=O)),$([N+](=O)[O-])])[#6][#6]1', '1', '2', 'EXCLUDE', '0', '0'],
      ['paranitrophenyl_esters', 'C(=O)Oc1ccc([N+](=O)[O-])cc1', '1', '2', 'EXCLUDE', '0', '0'],
      ['peptide_analogue_01', '[C!r3!r4!r5!r6!r7!r8!r9](=O)-NC[C!r3!r4!r5!r6!r7!r8!r9](=O)[N;!$([NH2]);!$(NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N);!$(NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N);$(N-;!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@A!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)]', '1', '2', 'EXCLUDE', '0', '1'],
      ['peptide_analogue_02', '[C!r3!r4!r5!r6!r7!r8!r9](=O)-NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)[N;!$([NH2]);!$(NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N);!$(NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N);$(N-;!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@A!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)]', '1', '2', 'EXCLUDE', '0', '1'],
      ['peptide_analogue_03', '[C!r3!r4!r5!r6!r7!r8!r9](=O)-NC[C!r3!r4!r5!r6!r7!r8!r9](=O)[N;!$([NH2]);!$(NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N);!$(NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N);$(N-;!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@A!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)]', '1', '2', 'EXCLUDE', '0', '1'],
      ['peptide_analogue_04', '[C!r3!r4!r5!r6!r7!r8!r9](=O)-NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)[N;!$([NH2]);!$(NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N);!$(NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N);$(N-;!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(N-;!@A!@A!@A!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)]', '1', '2', 'EXCLUDE', '0', '1'],
      ['peptide_analogue_05', '[C!r3!r4!r5!r6!r7!r8!r9](=O)-NC[C!r3!r4!r5!r6!r7!r8!r9](=O)[N;!$([NH2]);!$(NC[C!r3!r4!r5!r6!r7!r8!r9](=O)NC);!$(NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)NC);$(N([C!r3!r4!r5!r6!r7!r8!r9](=O)CN-[C!r3!r4!r5!r6!r7!r8!r9](=O))-;!@A-;!@N[C!r3!r4!r5!r6!r7!r8!r9](=O)CN[C!r3!r4!r5!r6!r7!r8!r9](=O)),$(N([C!r3!r4!r5!r6!r7!r8!r9](=O)CN-[C!r3!r4!r5!r6!r7!r8!r9](=O))-;!@A!@A-;!@N[C!r3!r4!r5!r6!r7!r8!r9](=O)CN[C!r3!r4!r5!r6!r7!r8!r9](=O)),$(N([C!r3!r4!r5!r6!r7!r8!r9](=O)CN-[C!r3!r4!r5!r6!r7!r8!r9](=O))-;!@A!@A!@A-;!@N[C!r3!r4!r5!r6!r7!r8!r9](=O)CN[C!r3!r4!r5!r6!r7!r8!r9](=O)),$(N([C!r3!r4!r5!r6!r7!r8!r9](=O)CN-[C!r3!r4!r5!r6!r7!r8!r9](=O))-;!@A!@A!@A!@A-;!@N[C!r3!r4!r5!r6!r7!r8!r9](=O)CN[C!r3!r4!r5!r6!r7!r8!r9](=O)),$(N([C!r3!r4!r5!r6!r7!r8!r9](=O)CN-[C!r3!r4!r5!r6!r7!r8!r9](=O))-;!@A!@A!@A!@A!@A-;!@N[C!r3!r4!r5!r6!r7!r8!r9](=O)CN[C!r3!r4!r5!r6!r7!r8!r9](=O)),$(N([C!r3!r4!r5!r6!r7!r8!r9](=O)CN-[C!r3!r4!r5!r6!r7!r8!r9](=O))-;!@A!@A!@A!@A!@A!@A-;!@N[C!r3!r4!r5!r6!r7!r8!r9](=O)CN[C!r3!r4!r5!r6!r7!r8!r9](=O)),$(N([C!r3!r4!r5!r6!r7!r8!r9](=O)CN-[C!r3!r4!r5!r6!r7!r8!r9](=O))-;!@A!@A!@A!@A!@A!@A!@A-;!@N[C!r3!r4!r5!r6!r7!r8!r9](=O)CN[C!r3!r4!r5!r6!r7!r8!r9](=O))]', '1', '2', 'EXCLUDE', '0', '1'],
      ['peptide_analogue_06', '[C!r3!r4!r5!r6!r7!r8!r9](=O)-NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)[N;!$([NH2]);!$(NC[C!r3!r4!r5!r6!r7!r8!r9](=O)NC);!$(NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)NC);$(N([C!r3!r4!r5!r6!r7!r8!r9](=O)CCN-[C!r3!r4!r5!r6!r7!r8!r9](=O))-;!@A-;!@N[C!r3!r4!r5!r6!r7!r8!r9](=O)CN[C!r3!r4!r5!r6!r7!r8!r9](=O)),$(N([C!r3!r4!r5!r6!r7!r8!r9](=O)CCN-[C!r3!r4!r5!r6!r7!r8!r9](=O))-;!@A!@A-;!@N[C!r3!r4!r5!r6!r7!r8!r9](=O)CN[C!r3!r4!r5!r6!r7!r8!r9](=O)),$(N([C!r3!r4!r5!r6!r7!r8!r9](=O)CCN-[C!r3!r4!r5!r6!r7!r8!r9](=O))-;!@A!@A!@A-;!@N[C!r3!r4!r5!r6!r7!r8!r9](=O)CN[C!r3!r4!r5!r6!r7!r8!r9](=O)),$(N([C!r3!r4!r5!r6!r7!r8!r9](=O)CCN-[C!r3!r4!r5!r6!r7!r8!r9](=O))-;!@A!@A!@A!@A-;!@N[C!r3!r4!r5!r6!r7!r8!r9](=O)CN[C!r3!r4!r5!r6!r7!r8!r9](=O)),$(N([C!r3!r4!r5!r6!r7!r8!r9](=O)CCN-[C!r3!r4!r5!r6!r7!r8!r9](=O))-;!@A!@A!@A!@A!@A-;!@N[C!r3!r4!r5!r6!r7!r8!r9](=O)CN[C!r3!r4!r5!r6!r7!r8!r9](=O)),$(N([C!r3!r4!r5!r6!r7!r8!r9](=O)CCN-[C!r3!r4!r5!r6!r7!r8!r9](=O))-;!@A!@A!@A!@A!@A!@A-;!@N[C!r3!r4!r5!r6!r7!r8!r9](=O)CN[C!r3!r4!r5!r6!r7!r8!r9](=O)),$(N([C!r3!r4!r5!r6!r7!r8!r9](=O)CCN-[C!r3!r4!r5!r6!r7!r8!r9](=O))-;!@A!@A!@A!@A!@A!@A!@A-;!@N[C!r3!r4!r5!r6!r7!r8!r9](=O)CN[C!r3!r4!r5!r6!r7!r8!r9](=O))]', '1', '2', 'EXCLUDE', '0', '1'],
      ['peptide_analogue_07', '[C!r3!r4!r5!r6!r7!r8!r9](=O)-NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)[N;!$([NH2]);!$(NC[C!r3!r4!r5!r6!r7!r8!r9](=O)NC);!$(NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)NC);$(N([C!r3!r4!r5!r6!r7!r8!r9](=O)CCN-[C!r3!r4!r5!r6!r7!r8!r9](=O))-;!@A-;!@N[C!r3!r4!r5!r6!r7!r8!r9](=O)CCN[C!r3!r4!r5!r6!r7!r8!r9](=O)),$(N([C!r3!r4!r5!r6!r7!r8!r9](=O)CCN-[C!r3!r4!r5!r6!r7!r8!r9](=O))-;!@A!@A-;!@N[C!r3!r4!r5!r6!r7!r8!r9](=O)CCN[C!r3!r4!r5!r6!r7!r8!r9](=O)),$(N([C!r3!r4!r5!r6!r7!r8!r9](=O)CCN-[C!r3!r4!r5!r6!r7!r8!r9](=O))-;!@A!@A!@A-;!@N[C!r3!r4!r5!r6!r7!r8!r9](=O)CCN[C!r3!r4!r5!r6!r7!r8!r9](=O)),$(N([C!r3!r4!r5!r6!r7!r8!r9](=O)CCN-[C!r3!r4!r5!r6!r7!r8!r9](=O))-;!@A!@A!@A!@A-;!@N[C!r3!r4!r5!r6!r7!r8!r9](=O)CCN[C!r3!r4!r5!r6!r7!r8!r9](=O)),$(N([C!r3!r4!r5!r6!r7!r8!r9](=O)CCN-[C!r3!r4!r5!r6!r7!r8!r9](=O))-;!@A!@A!@A!@A!@A-;!@N[C!r3!r4!r5!r6!r7!r8!r9](=O)CCN[C!r3!r4!r5!r6!r7!r8!r9](=O)),$(N([C!r3!r4!r5!r6!r7!r8!r9](=O)CCN-[C!r3!r4!r5!r6!r7!r8!r9](=O))-;!@A!@A!@A!@A!@A!@A-;!@N[C!r3!r4!r5!r6!r7!r8!r9](=O)CCN[C!r3!r4!r5!r6!r7!r8!r9](=O)),$(N([C!r3!r4!r5!r6!r7!r8!r9](=O)CCN-[C!r3!r4!r5!r6!r7!r8!r9](=O))-;!@A!@A!@A!@A!@A!@A!@A-;!@N[C!r3!r4!r5!r6!r7!r8!r9](=O)CCN[C!r3!r4!r5!r6!r7!r8!r9](=O))]', '1', '2', 'EXCLUDE', '0', '1'],
      ['peptide_analogue_08', 'N[C!r3!r4!r5!r6!r7!r8!r9](=O)CN[C!r3!r4!r5!r6!r7!r8!r9](=O)-;!@[C;$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@A!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@A!@A!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@A!@A!@A!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)]', '1', '2', 'EXCLUDE', '0', '1'],
      ['peptide_analogue_09', 'N[C!r3!r4!r5!r6!r7!r8!r9](=O)CCN[C!r3!r4!r5!r6!r7!r8!r9](=O)-;!@[C;$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@A!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@A!@A!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@A!@A!@A!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)]', '1', '2', 'EXCLUDE', '0', '1'],
      ['peptide_analogue_10', 'N[C!r3!r4!r5!r6!r7!r8!r9](=O)CCN[C!r3!r4!r5!r6!r7!r8!r9](=O)-;!@[C;$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@A!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@A!@A!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N),$(C(-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)!@A!@A!@A!@A!@A!@A!@A!@C-;!@[C!r3!r4!r5!r6!r7!r8!r9](=O)NCC[C!r3!r4!r5!r6!r7!r8!r9](=O)N)]', '1', '2', 'EXCLUDE', '0', '1'],
      ['perchlorates', 'OCl(O)(O)(O)', '1', '2', 'EXCLUDE', '0', '0'],
      ['perchloro_cp', 'C1(Cl)(Cl)C(Cl)C(Cl)=C(Cl)C1(Cl)', '1', '2', 'EXCLUDE', '0', '0'],
      ['perchloroquinone', '[OX1]=[CX3]1C([F,Cl,Br,I])=C([F,Cl,Br,I])[CX3](=[OX1])C([F,Cl,Br,I])=C1[F,Cl,Br,I]', '1', '2', 'EXCLUDE', '0', '0'],
      ['perhalo_phenyl', 'c1c([F,Br,Cl,I])c([F,Br,Cl,I])c([F,Br,Cl,I])c([F,Br,Cl,I])c1([F,Br,Cl,I])', '1', '2', 'EXCLUDE', '0', '0'],
      ['permanent_positive_charge', '[+1;H0;!$([+1]~[-1])]', '1', '1', 'FLAG', '0', '0'],
      ['peroxide_endo', 'A-O-O-A', '1', '2', 'EXCLUDE', '1', '0'],
      ['peroxide_terminal', 'A-O-[O;H1]', '1', '2', 'EXCLUDE', '0', '0'],
      ['phenalene', 'c1(c)c2c(c)cccc2ccc1', '1', '2', 'EXCLUDE', '0', '0'],
      ['phenanthren ', 'c12ccccc1ccc3ccccc23', '1', '2', 'EXCLUDE', '0', '0'],
      ['phenol_ester', 'c1ccccc1OC(=O)[#6]', '1', '0', 'ANNOTATION', '0', '0'],
      ['phenolic_OH_count_2', '[c;$(c1ccccc1),$(c1ccac1)][OH]', '2', '1', 'FLAG', '0', '0'],
      ['phenolic_OH_count_3', '[c;$(c1ccccc1),$(c1ccac1)][OH]', '3', '2', 'EXCLUDE', '0', '0'],
      ['phenoxazines', '[OX1,N]=[#6]1-,:[#6]=,:[#6]2-,:[#16X2,#8X2]-,:[#6]3=,:[#6]-,:[#6](=,:[#6]-,:[#6]=,:[#6]3-,:[#7]=,:[#6]2-,:[#6]=,:[#6]1)', '1', '2', 'EXCLUDE', '0', '0'],
      ['phenyl_DHP', '[#6]1(-,:[#6;$([#6]=[#8,#7&v3,#16&v2]),$([#6]#[#7])])=,:[#6]-N-[#6]=,:[#6](-,:[#6;$([#6]=[#8,#7&v3,#16&v2]),$([#6]#[#7])])-[C;X4]1-c2ccccc2', '1', '0', 'ANNOTATION', '0', '0'],
      ['phosphazenes', '[#15]1~[#7]~[#15]~[#7]~[#15]~[#7]1', '1', '2', 'EXCLUDE', '0', '0'],
      ['phospho_threonine', 'NC(C(C)OP(O)(O)=O)C(O)=O', '1', '2', 'EXCLUDE', '0', '0'],
      ['phosphonamide_thiophosphonic_anhydride', '[#15!$([#15](~[#8;X1])(-[#7])(-[#8])-[#8])](~[#8;X1])-[#16,#7&H1]', '1', '2', 'EXCLUDE', '0', '0'],
      ['phosphor_not_PO3_PO4', '[P;!$(P(~O)(~O)~O)]', '1', '1', 'FLAG', '0', '0'],
      ['phosphoramides', 'NP(=O)(N)N', '1', '2', 'EXCLUDE', '0', '0'],
      ['phosphorus_phosphorus_bond', 'P~P', '1', '2', 'EXCLUDE', '0', '0'],
      ['PO3 _groups', 'P(~O)(~O)~O', '1', '0', 'ANNOTATION', '0', '0'],
      ['polycyclic_systems_14_atoms', 'a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a', '1', '0', 'ANNOTATION', '0', '0'],
      ['polycyclic_systems_16_atoms', 'a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a', '1', '1', 'FLAG', '0', '0'],
      ['polycyclic_systems_18_atoms', 'a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a@;:a', '1', '2', 'EXCLUDE', '0', '0'],
      ['polyenes', 'C=C-C=!@C-C=C', '1', '2', 'EXCLUDE', '0', '0'],
      ['polyhalo_phenol_1', 'c1c([O;D1])c(-[Cl,Br,I])cc(-[Cl,Br,I])c1.c1c([O;D1])c(-[Cl,Br,I])cc(-[Cl,Br,I])c1', '1', '2', 'EXCLUDE', '0', '0'],
      ['polyhalo_phenol_2', 'c1c([O;D1])ccc(-[Cl,Br,I])c(-[Cl,Br,I])1.c1c([O;D1])ccc(-[Cl,Br,I])c(-[Cl,Br,I])1', '1', '2', 'EXCLUDE', '0', '0'],
      ['polyhalo_phenol_3', 'c(-[Cl,Br,I])1c([O;D1])c(-[Cl,Br,I])ccc1.c(-[Cl,Br,I])1c([O;D1])c(-[Cl,Br,I])ccc1', '1', '2', 'EXCLUDE', '0', '0'],
      ['polyhalo_phenol_esters', 'C(=O)Oc1c([Cl,F])[cH1,$(c[F,Cl])]c([F,Cl])[cH1,$(c[F,Cl])]c1([F,Cl])', '1', '2', 'EXCLUDE', '0', '0'],
      ['polyhalogenated_aromate', '[c;$(cc(-[F,Cl,Br,I])c-[F,Cl,Br,I]),$(cc(-[F,Cl,Br,I])cc-[F,Cl,Br,I]),$(ccc(-[F,Cl,Br,I])cc-[F,Cl,Br,I])]-[F,Cl,Br,I]', '1', '1', 'FLAG', '0', '0'],
      ['porphyrin', '[#6;r16,r17,r18]~[#6]1~[#6]~[#6]~[#6](~[#6])~[#7]1', '1', '2', 'EXCLUDE', '0', '0'],
      ['prostaglandine', '[C!R]-[C!R]-[C!R]-[C!R]-[C!R]-[C!R]-[C!R]-,=[C!R]-C1~C~C~C~C~1-C-C-,=[C!R]-[C!R]-[C!R]-[C!R]-C(=O)-O', '1', '2', 'EXCLUDE', '0', '1'],
      ['pyranone', 'O=C1C=COC=C1', '1', '1', 'FLAG', '0', '0'],
      ['pyrimidinetriones', '[#6]1=,:[#6]([OH1])-,:[#7X3]-,:[#6X3](=[OX1])-,:[#7X3]-,:[#6X3]-,:1(=[OX1])', '1', '1', 'FLAG', '0', '0'],
      ['pyrimido_triazine_dione', '[#6&X3]1(~[#8])~[#7]~[#6&X3](~[#8])~[#7]~[#6&X3]2~[#6&X3]~1~[#7&X2]~[#6&X3]~[#6&x3,#7&X2]~[#7,#16&v2]~2', '1', '1', 'FLAG', '0', '0'],
      ['pyrimidotriazinedione', '[n]1:[n]:[c]:[n]:[c](:[c]12)-[#6](=[#8])-[#7]-[#6](=[#8])-[#7]2', '1', '0', 'ANNOTATION', '0', '0'],
      ['pyrrole_1', 'n2(-[#6]:1:[!#1]:[#6]:[#6]:[#6]:[#6]:1)c(cc(c2-[#6;X4])-[#1])-[#6;X4]', '1', '0', 'ANNOTATION', '0', '0'],
      ['pyrrole_2', 'n2(-[#6]:1:[!#1]:[#6]:[#6]:[#6]:[#6]:1)c(cc(c2-[#6]:[#6])-[#1])-[#6;X4]', '1', '0', 'ANNOTATION', '0', '0'],
      ['pyrrolo_quinoxalin_amine', '[NH,NH2]-c1nc2nc3ccccc3nc2c1', '1', '0', 'ANNOTATION', '0', '0'],
      ['quinolin_8_ol', '[OH]-c1cccc2ccc[n;X2]c12', '1', '2', 'EXCLUDE', '0', '0'],
      ['quinone_1_2', '[#6]1-,:[#6](=;!@[#8,#7,#16])-,:[#6](=;!@[#8,#7,#16])-,:[#6]=,:[#6]-,:[#6]=,:1', '1', '2', 'EXCLUDE', '1', '0'],
      ['quinone_1_4', '[#6]1-,:[#6](=[#8,#7,#16])-,:[#6]=,:[#6]-,:[#6](=[#8,#7,#16])-,:[#6]=,:1', '1', '2', 'EXCLUDE', '1', '0'],
      ['quinone_methide', '[#6;!$([#6](-[N,O,S]))]1=[#6;!$([#6](-[N,O,S]))][#6](=[#6])[#6;!$([#6](-[N,O,S]))]=[#6;!$([#6](-[N,O,S]))][#6]1(=[O,N,S])', '1', '2', 'EXCLUDE', '0', '0'],
      ['quinone_methide_1_2', '[#6]1-,:[#6](=[#6!R!$(C-[O,N,S])])-,:[#6](=[#8,#7,#16])-,:[#6]=,:[#6]-,:[#6]=,:1', '1', '2', 'EXCLUDE', '1', '0'],
      ['quinone_methide_1_4', '[#6]1-,:[#6](=[#6!R!$(C-[O,N,S])])-,:[#6]=,:[#6]-,:[#6](=[#8,#7,#16])-,:[#6]=,:1', '1', '2', 'EXCLUDE', '1', '0'],
      ['reactive_halo_pyrazine', '[#7;R1]1[#6]([F,Cl,Br,I])[#6;!$(c-N)][#7][#6]([$(S(=O)(=O)),$(C(F)(F)(F)),$(C#N),$(N(=O)(=O)),$([N+](=O)[O-]),$(C=O)])[#6;!$(c-N)]1', '1', '0', 'ANNOTATION', '1', '0'],
      ['reactive_halo_pyrazine_2', '[#7;R1]1[#6]([F,Cl,Br,I])[#6]([$(S(=O)(=O)),$(C(F)(F)(F)),$(C#N),$(N(=O)(=O)),$([N+](=O)[O-]),$(C=O)])[#7][#6][#6]1', '1', '1', 'FLAG', '1', '0'],
      ['reactive_halo_pyridazine', '[#7;R1]1[#6]([F,Cl,Br,I])[#6]([$(S(=O)(=O)),$(C(F)(F)(F)),$(C#N),$(N(=O)(=O)),$([N+](=O)[O-]),$(C=O)])[#6][#6][#7]1', '1', '0', 'ANNOTATION', '1', '0'],
      ['reactive_halo_pyridine', '[#7;R1]1[#6;!$(c=O);!$(c-N)][#6]([$(S(=O)(=O)),$(C(F)(F)(F)),$(C#N),$(N(=O)(=O)),$([N+](=O)[O-]),$(C=O)])[#6]([F,Cl,Br,I])[#6][#6;!$(c=O);!$(c-N)]1', '1', '1', 'FLAG', '1', '0'],
      ['reactive_halo_pyrimidine', '[#7;R1]1[#6]([F,Cl,Br,I])[#7][#6][#6]([$(S(=O)(=O)),$(C(F)(F)(F)),$(C#N),$(N(=O)(=O)),$([N+](=O)[O-]),$(C=O)])[#6]1', '1', '1', 'FLAG', '1', '0'],
      ['reactive_halogen_on_carbon_with_heteroatom', '[Cl,Br,I]-[CH2,$([CH](-[Cl,Br,I])-[Cl,Br,I])]-[#7&X3,#15&X3,#5&X3,#8]', '1', '2', 'EXCLUDE', '1', '0'],
      ['reactive_halogen_on_carbon_with_S', '[Cl,Br,I]-[CH2,$([CH](-[Cl,Br,I])-[Cl,Br,I])]-[#16]', '1', '2', 'EXCLUDE', '0', '0'],
      ['retinoid', 'C-[CH]=C(-[CH3])-[CH]=[CH]-[CH]=C(-[CH3])-[CH]=[CH]-[#6]1:,=[#6]:,-[#6]:,-[#6]:,-[#6]:,-[#6]-,=1', '1', '2', 'EXCLUDE', '0', '1'],
      ['rhodamine_sat', '[#7]-1-[#6](=[#16])-[#16]-[#6;X4]-[#6]-1=[#8]', '1', '2', 'EXCLUDE', '0', '0'],
      ['rhodamine', '[#7&v3,#8,#16&v2]=,-[#6;X3]1-,:[#6]=,:[#6]-,:[#6]2=,:[#6]-,:[#6]3:[#6]:[#6]:[#6](-[#7&v3,#8,#16&v2]):[#6]:[#6]:3-,:[#7&v3,#8,#16&v2]-,:[#6]-,:2=,:[#6]-,:1', '1', '2', 'EXCLUDE', '0', '1'],
      ['rhodanine', 'C(=C)1SC(=S)NC(=O)1', '1', '0', 'ANNOTATION', '0', '0'],
      ['ring_triple_bond', '[C,c;R]#[C,c;R]', '1', '0', 'ANNOTATION', '0', '0'],
      ['S_N_double_bond_acyclic', 'S=!@N', '1', '0', 'ANNOTATION', '0', '0'],
      ['S_S_single_bond', '[#16]~[#16]', '1', '2', 'EXCLUDE', '0', '0'],
      ['saponin_derivatives', 'O1CCCCC1OC2CCC3CCCCC3C2', '1', '2', 'EXCLUDE', '0', '0'],
      ['Si_N_bonds', '[Si]~N ', '1', '2', 'EXCLUDE', '0', '0'],
      ['SO3_groups', 'S(~O)(~O)~O', '1', '2', 'EXCLUDE', '0', '0'],
      ['sp3_carbon_with_4_het_substit', '[!#6;!Cl;!F;!#1]-[#6](-[!#6;!F;!C;!#1])(-[!#6;!F;!Cl;!#1])-[!#6;!F;!C;!#1]', '1', '2', 'EXCLUDE', '0', '0'],
      ['sphingosine', 'C~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH2,CH&X3,CX2,$([CH]-[OH])]~!@[CH](-O)-[CH](-[N!$(N~[O,N,S])])-[CH2]-[OH]', '1', '2', 'EXCLUDE', '0', '1'],
      ['ss_double_bond', 'S=S', '1', '2', 'EXCLUDE', '0', '0'],
      ['staurosporine', 'O=[#6]1-,:[#7]-,:[#6]-,:c2c1c3c4ccccc4nc3c5nc6ccccc6c52', '1', '0', 'ANNOTATION', '0', '0'],
      ['steroid', '[O;!$(O=C1C=C2CCCCC2CC1)]=C1C=C2C=,-CC3C4CCCC4CCC3-,=C2CC1', '1', '1', 'FLAG', '0', '0'],
      ['steroid_a_arom', 'c12ccccc1C=,-C-,=C-,=3-,=C-,=2-,=C-,=C-,=C4-,=C-,=C-,=C-,=C-,=4-,=3', '1', '2', 'EXCLUDE', '0', '1'],
      ['steroid_non_arom', 'C12-,=C-,=C-,=C-,=C-,=C-,=1-,=C=,-C-,=C3-,=C-,=2-,=C-,=C-,=C4-,=C-,=C-,=C-,=C-,=4-,=3', '1', '2', 'EXCLUDE', '0', '1'],
      ['stilbene_analogs', 'acC=&!@Cca', '1', '0', 'ANNOTATION', '0', '0'],
      ['sulfanamine', '[S;D3](-N)(-[c,C])(-[c,C])', '1', '2', 'EXCLUDE', '0', '0'],
      ['sulfanetriol', 'S(O)(O)(O)', '1', '2', 'EXCLUDE', '0', '0'],
      ['sulfonic_acid_nitril', '[#8;X1]~[#16]-[#6]#[#7]', '1', '2', 'EXCLUDE', '1', '0'],
      ['sulfonyl_anhydride', '[$(C(=O)),$(S(=O)(=O))][O,S](S(=O)(=O))', '1', '2', 'EXCLUDE', '0', '0'],
      ['sulfonyl_count_2', 'O=S=O', '2', '0', 'ANNOTATION', '0', '0'],
      ['sulfonyl_cyanides', 'S(=O)(=O)C#N', '1', '2', 'EXCLUDE', '0', '0'],
      ['sulfonyl_fluoride', 'F-S(=O)(=O)-[#6]', '1', '0', 'ANNOTATION', '1', '0'],
      ['sulfur_nitrogen_singleBond', '[SX2H0][N]', '1', '2', 'EXCLUDE', '0', '0'],
      ['terminal_vinyl', '[CH2]=[CH][N,O,P,S;R0]', '1', '0', 'ANNOTATION', '0', '0'],
      ['tert_butyl_count_3', 'C([CH3])([CH3])[CH3]', '3', '1', 'FLAG', '0', '0'],
      ['tertiary_halide_sulfate', '[C;X4](-[R0;Cl,Br,I,$(O(S(=O)(=O)[!$(N);!$([O&D1])]))])(-[c,C])(-[c,C])(-[c,C])', '1', '2', 'EXCLUDE', '0', '0'],
      ['tetraazinane', 'C1NNC=NN1', '1', '2', 'EXCLUDE', '0', '0'],
      ['thiadiazolones', '[#8]=[#6]1-,:[#7&v3]-,:[#16&v2]-,:[#6]=,:[#7&v3]1', '1', '0', 'ANNOTATION', '0', '0'],
      ['thiatetrazolidine', '[$(Sc1nnn[nH,n-]1),$(Sc1nn[nH,n-]n1)]', '1', '2', 'EXCLUDE', '0', '0'],
      ['thiazolidine_2_4_dione_5_met', '[#6]=[#6]1~[#6;X3](~!@[#7&v3,#8,#16&v2;$(A=[#6]),$(A-[#6]=[#7])])~[#7]~[#6;X3](~[#7&v3,#8,#16&v2;$(*=,:[#6]),$(*-,:[#6]=[#7])])~[#16&v2]1', '1', '0', 'ANNOTATION', '0', '0'],
      ['thiazolidinediones', '[O;$(O=C-[NH]),$(O=C-N=C),$([OH]-C=N)]~[C;X3]1~[N]~[C;X3](~[O;$(O=C-[NH]),$(O=C-N=C),$([OH]-C=N)])-S-[CH]1-[#6]', '1', '0', 'ANNOTATION', '0', '0'],
      ['thiazolidines', '[S;X2]1[C;X4;R1]N[C;R1][C;R1]1', '1', '1', 'FLAG', '0', '0'],
      ['thio_ketone', '[#6]-[#6](=[#16])-[#6]', '1', '0', 'ANNOTATION', '0', '0'],
      ['thiobenzothiazole_2', 'c12ccccc1(SC(=S)N2)', '1', '2', 'EXCLUDE', '0', '0'],
      ['thiobenzothiazole_1', 'c12ccccc1(SC(S)=N2)', '1', '2', 'EXCLUDE', '0', '0'],
      ['thiocarbamate', 'S!@C(=!@[O,S])!@[#7]', '1', '2', 'EXCLUDE', '0', '0'],
      ['thiocarbamate_5_ring', '[#7,#16&v2;$([#7,#16]=[#6]1-[#7]-[#6]-[#7,#6]-[#16]-1),$([#7,#16;H1,H2]-[#6]1=[#7]-[#6]-[#7,#6]-[#16]-1)]=,-[#6]1=,-[#7]-[#6&X4]-[#7,#6&X4]-[#16&v2]-1', '1', '1', 'FLAG', '0', '0'],
      ['thiocarbonate', 'SC(=O)[O,S]', '1', '2', 'EXCLUDE', '0', '0'],
      ['thiocyanate', '[#16]-[#6]#[#7]', '1', '2', 'EXCLUDE', '0', '0'],
      ['thioester_acyclic', '[#6;R0;$([#6](=[#8])-[#16;v2]),$([#6](=[#16;v2])-[#8,#16;v2])]', '1', '0', 'ANNOTATION', '0', '0'],
      ['thioester_thiolactone', '[S;X2;H0]C=[O,N]', '1', '1', 'FLAG', '0', '0'],
      ['thioether_count_2', '[#6]-[S;X2]-[#6]', '2', '2', 'EXCLUDE', '0', '0'],
      ['thiol_count_2', '[#16;H1;X2;!$([#16]-[#6](-,:[#7,#8,#16])=,:[#7])]', '2', '2', 'EXCLUDE', '0', '0'],
      ['thiomorpholinedione', 'N1C(=O)CSCC1=O', '1', '0', 'ANNOTATION', '0', '0'],
      ['thionoester', 'COC(=S)C', '1', '2', 'EXCLUDE', '0', '0'],
      ['thioperoxide', 'A-[S;X2]-O', '1', '2', 'EXCLUDE', '0', '0'],
      ['thiophene_hydroxy', 's1ccc(c1)-[#8]-[#1]', '1', '2', 'EXCLUDE', '0', '0'],
      ['thiophene_simple', 's1[c;H1,$(c-[F,Cl,Br,I]),$(c-[#7](~[#8&X1])~[#8&X1])][c;H1,$(c-[F,Cl,Br,I]),$(c-[#7](~[#8&X1])~[#8&X1])]c[c;H1,$(c[cH]),$(c-[F,Cl,Br,I]),$(cc-[F,Cl,Br,I]),$(c-[#7](~[#8&X1])~[#8&X1]),$(cc-[#7](~[#8&X1])~[#8&X1])]1', '1', '0', 'ANNOTATION', '0', '0'],
      ['thiophosphothionate', 'P(=S)(-[S;H1,H0$(S(P)C)])(-[O;H1,H0$(O(P)C)])(-N(C)C)', '1', '2', 'EXCLUDE', '0', '0'],
      ['thiosulfoxide', '[C,c][S;X3](~O)-S', '1', '2', 'EXCLUDE', '0', '0'],
      ['thiourea_thioester_cyclic', '[#16&v2]~[#6&X3&R1;!$([#6]1(-A):[a;!$(a=*);!$(nc-[#8,#16&v2;H1]);!$(nc=[#8,#16&v2])][a;!$(a=*);!$(nc-[#8,#16&v2;H1]);!$(nc=[#8,#16&v2])][a;!$(a=*);!$(nc-[#8,#16&v2;H1]);!$(nc=[#8,#16&v2])][a;!$(a=*);!$(nc-[#8,#16&v2;H1]);!$(nc=[#8,#16&v2])][a;!$(a=*);!$(nc-[#8,#16&v2;H1]);!$(nc=[#8,#16&v2])]1);!$([#6]1(-A):[a;!$(a=*);!$(nc-[#8,#16&v2;H1]);!$(nc=[#8,#16&v2])][a;!$(a=*);!$(nc-[#8,#16&v2;H1]);!$(nc=[#8,#16&v2])][a;!$(a=*);!$(nc-[#8,#16&v2;H1]);!$(nc=[#8,#16&v2])][a;!$(a=*);!$(nc-[#8,#16&v2;H1]);!$(nc=[#8,#16&v2])]1)](~[#7&v3])~@[#7&v3,#6]', '1', '1', 'FLAG', '0', '0'],
      ['thiuram_disulfide_dithiocarbamate', '[#16&v2]~[#6&X3;!$([#6]1(-A):[a;!$(a=*);!$(nc-[#8,#16&v2;H1]);!$(nc=[#8,#16&v2])][a;!$(a=*);!$(nc-[#8,#16&v2;H1]);!$(nc=[#8,#16&v2])][a;!$(a=*);!$(nc-[#8,#16&v2;H1]);!$(nc=[#8,#16&v2])][a;!$(a=*);!$(nc-[#8,#16&v2;H1]);!$(nc=[#8,#16&v2])][a;!$(a=*);!$(nc-[#8,#16&v2;H1]);!$(nc=[#8,#16&v2])]1);!$([#6]1(-A):[a;!$(a=*);!$(nc-[#8,#16&v2;H1]);!$(nc=[#8,#16&v2])][a;!$(a=*);!$(nc-[#8,#16&v2;H1]);!$(nc=[#8,#16&v2])][a;!$(a=*);!$(nc-[#8,#16&v2;H1]);!$(nc=[#8,#16&v2])][a;!$(a=*);!$(nc-[#8,#16&v2;H1]);!$(nc=[#8,#16&v2])]1)](~[#7&v3])~[#16&v2]', '1', '0', 'ANNOTATION', '0', '0'],
      ['triacylamine', '[$(N(-C(=O))(-C(=O))(-C(=O))),$(n([#6](=O))([#6](=O))([#6](=O)))]', '1', '2', 'EXCLUDE', '0', '0'],
      ['triaryl_phosphine_oxide', 'P(=O)(a)(a)(a)', '1', '2', 'EXCLUDE', '0', '0'],
      ['triazine_alkyl', '[#7;v3;!$(N1N=N[#6]=,:[#6]1);!$(N1N=N[#7]=,:[#6]1);!$(N1N=N[#6]=,:[#6]-[#6](=[#8,#7&v3,#16&v2])1);!$(N1N=N[#6](=[#8,#7&v3,#16&v2])-[#6]=,:[#6]1);!$(N1N=N[#8,#7&v3,#16&v2]C1=[#8,#7&v3,#16&v2]);!$(N1N=NC(=[#8,#7&v3,#16&v2])[#8,#7&v3,#16&v2]1);!$(N1N=NC(=[#8,#7&v3,#16&v2])[#8,#7&v3,#16&v2]C(=[#8,#7&v3,#16&v2])1);!$(N1N=NC(=[#8,#7&v3,#16&v2])C(=[#8,#7&v3,#16&v2])[#8,#7&v3,#16&v2]1);!$(N1N=N[#8,#7&v3,#16&v2]C(=[#8,#7&v3,#16&v2])C1(=[#8,#7&v3,#16&v2]))]-!@[#7;v3]=!@[#7;v3]', '1', '2', 'EXCLUDE', '0', '0'],
      ['triazolol_esters', 'c1cnnn1-O-C=O', '1', '1', 'FLAG', '1', '0'],
      ['tricarbonyls', '[$(O=C[CH](C=O)C=O),$(O=CC(C=O)=C[OH]),$(N#C[CH](-C=O)-C=O),$(N#CC(-C=O)=C[OH])] ', '1', '1', 'FLAG', '0', '0'],
      ['trichloromethyl_ketone', '[$(C(=O));!$(C-N);!$(C-O);!$(C-S)]C(Cl)(Cl)(Cl)', '1', '2', 'EXCLUDE', '0', '0'],
      ['triflates_aliphatic', '[CX4]O-S(=O)(=O)-C(F)(F)F', '1', '2', 'EXCLUDE', '1', '0'],
      ['triflates_aromatic', '[C!X4]O-S(=O)(=O)-C(F)(F)F', '1', '1', 'FLAG', '1', '0'],
      ['trifluoro_ethanol', 'FC(F)(F)-[CH2]-[O;$(O-C=O),$(O-[Si]),H1]', '1', '1', 'FLAG', '0', '0'],
      ['trifluoro_trichloro_acetic_aci', '[F,Cl,Br,I]C([F,Cl,Br,I])([F,Cl,Br,I])[#6;$([#6](=[#8,#7&v3,#16&v2])[#8,#16&v2]),$([#6;H1]=[#8,#7&v3,#16&v2]),$([#6](-[#8,#7&v3,#16&v2,#15v3])-[#8,#7&v3,#15v3])]', '1', '1', 'FLAG', '0', '0'],
      ['trifluoroacetate_thioester', 'C(F)(F)(F)C(=O)S', '1', '2', 'EXCLUDE', '0', '0'],
      ['trifluoromethyl_ketone', '[$(C(=O));!$(C-N);!$(C-O);!$(C-S)]C(F)(F)(F)', '1', '0', 'ANNOTATION', '0', '0'],
      ['trifluroacetate_amide', 'FC(F)(F)C(=O)N', '1', '0', 'ANNOTATION', '0', '0'],
      ['triphenyl_Silyl', '[Si](c1ccccc1)(c2ccccc2)(c3ccccc3)', '1', '0', 'ANNOTATION', '0', '0'],
      ['trityl_group_simple', '[#6](-c1[cH][cH]c[cH][cH]1)(-c1[cH][cH]c[cH][cH]1)-c1[cH][cH]c[cH][cH]1', '1', '2', 'EXCLUDE', '0', '0'],
      ['tropone', 'C1C(=O)C=CC=CC=1', '1', '2', 'EXCLUDE', '1', '0'],
      ['vinyl_carbonyl_EWG', '[C;!R]([$(S(=O)(=O)),$(C(F)(F)(F)),$(C#N),$(N(=O)(=O)),$([N+](=O)[O-]),$(C=O)])([$(S(=O)(=O)),$(C(F)(F)(F)),$(C#N),$(N(=O)(=O)),$([N+](=O)[O-]),$(C=O)])=[C;!R]([C;!R](=O))([!$([#8]);!$([#7])])', '1', '2', 'EXCLUDE', '1', '0'],
      ['vinyl_sulphone', '[#6][CH1]!@=[CH1][S;H1,H0$(S(C)C)](=O)(=O)', '1', '0', 'ANNOTATION', '1', '0'],
      ['xanthate', '[#16]=[#6](-[#16])-[#8,#16;H1,R0,$(*-[C;X4])]', '1', '2', 'EXCLUDE', '1', '0'],
  ]
  # Build the filter catalog using the RDKit filterCatalog module
  #     - value: novartis
  #    text: Novartis Screening Filters
  # The SubstructureFilters aren't shipped in the contrib directory, we could add them to the script
  #  here or in the pylib for now
  def NovartisCatalog():
      nibrCat = FilterCatalog.FilterCatalog()
      for PATTERN_NAME, SMARTS, MIN_COUNT, SEVERITY_SCORE, SEVERITY_COMMENT, COVALENT, SPECIAL_MOL in NIBR:
          mincount = 1
          MIN_COUNT = int(MIN_COUNT)
          if MIN_COUNT:
              mincount = MIN_COUNT

          # the NIBR catalog calculates a severity score among other things
          #  that we don't expose.  They also compose fraction NO
          #  and also have a "special mol" flag which I don't quite understand yet
          pname_final = f'{PATTERN_NAME} {SEVERITY_COMMENT}'
          if int(COVALENT):
             pname_final += ' (covalent)'
          if int(SPECIAL_MOL):
             pname_final += ' (special molecule)'
          fil = FilterCatalog.SmartsMatcher(pname_final, SMARTS, mincount)
          entry = FilterCatalog.FilterCatalogEntry(pname_final, fil)
          description = f'{PATTERN_NAME} {MIN_COUNT=} {SEVERITY_SCORE=} {SEVERITY_COMMENT=} {COVALENT=} {SPECIAL_MOL=}'
          entry.SetDescription(pname_final)
          entry.SetProp('FilterSet', "Novartis")
          nibrCat.AddEntry(entry)
      return nibrCat
  
  def special_atom(atom):
        bonds = list(atom.GetBonds())
        # keep valence maintaining bonds by adding Hs
        if len(bonds) == 1:
            oatom = bonds[0].GetOtherAtom(atom)
            if oatom.GetAtomicNum() == 7 and oatom.GetIsAromatic():
                oatom.SetNumExplicitHs(oatom.GetNumExplicitHs()+1)
                bonds[0].SetBoolProp("keep", True)
                return False
        # keep exo double bounds?
        return False

  def extract_rings(mol):
        """Given a molecule, return the list of ring systems in smiles format"""
        m = Chem.RWMol(mol)
        m.BeginBatchEdit()
        for atom in m.GetAtoms():
            if not atom.IsInRing() and not special_atom(atom):# and not exo_dbl(atom):
                m.RemoveAtom(atom.GetIdx())
        for bond in m.GetBonds():
            if not bond.IsInRing() and not bond.HasProp("keep"):
                m.RemoveBond(bond.GetBeginAtomIdx(), bond.GetEndAtomIdx())

        m.CommitBatchEdit()
        smi = Chem.MolToSmiles(m).split('.')
        return smi

  def get_source(entry: FilterCatalog.FilterCatalogEntry):
      if "FilterSet" in entry.GetPropList():
          filterset = entry.GetProp("FilterSet")
          return f": {filterset}"
      return ""
  
  def filter_compounds(mols: list[Chem.Mol], filters: list[str], add_source=True):
      """
      Given a list of moleculs and alist of filters, filter the compounds against the filter sets
      """
      catalogs = []
      chembl_filtered = {}
      notifications = []
      
      logging.info(f"{filters}")
      if "chembl rings" in filters:
          filters = filters[:]
          filters.remove("chembl rings")
          if RING_DB:
              t1 = time.time()
              rings = marshal.load(gzip.open(RING_DB, "rb"))
              t2 = time.time()
              logging.info(f"Took {t2-t1:0.2} seconds to load ring db")
              t1 = time.time()
              for i,mol in enumerate(mols):
                  if mol is None:
                      continue
                  for ring in extract_rings(mol):
                      if ring not in rings:
                          chembl_filtered[i] = "Ring system not in chembl 34"
                          break
              t2 = time.time()
              logging.info(f"Took {t2-t1:0.2} seconds to ring identify {len(mols)}")
          else:
              notifications.append(Notification(level = NotificationLevel.WARNING,
                                                title = "Missing CheMBL Rings",
                                                summary = "ChEMBL ring data base is missing",
                                                details = "ChEMBL Ring Database not installed"))

      for filterset in filters:
          if filterset == "novartis":
              catalogs.append(NovartisCatalog())
          else:
              param = CATALOGS.get(filterset)
              if not param:
                  raise ValueError(f"Filter catalog {filterset} not available")
              catalogs.append(FilterCatalog.FilterCatalog(param))

      filter_column = []
      match_column = []
      logging.info(f"{filters}")
      if not filters: # must have been chembl rings only
          filter_column = ["Filtered" if i in chembl_filtered else "Ok" for i in range(len(mols))]
          match_column = [chembl_filtered.get(i,'') for i in range(len(mols))]
          return filter_column, match_column
      
      for i,mol in enumerate(mols):
          if mol is None:
              filter_column.append("Filtered")
              match_column.append("RDKit: Failed Sanitization")
          else:              
              matches = []
              for catalog in catalogs:
                  # add source?
                  matches.extend([f"{x.GetDescription()}{get_source(x)}" for x in catalog.GetMatches(mol)])
              if i in chembl_filtered:
                  matches.append(chembl_filtered[i])
                  
              if not matches:
                  filter_column.append("Ok")
              else:
                  filter_column.append("Filtered")

              match_column.append("\n".join(matches))
      return filter_column, match_column, notifications
  
  def execute(request: DataFunctionRequest) -> DataFunctionResponse:
      column_id = string_input_field(request, 'structureColumn')
      input_column = request.inputColumns[column_id]
      t1 = time.time()
      mols = column_to_molecules(input_column)
      t2 = time.time()
      logging.info(f"Took {t2-t1:0.2} seconds to load input molecules")

      screening_filters = request.inputFields['screening_filters'].data
      logging.info(f"{screening_filters=}")
      filter_column, matches_column, notifications = filter_compounds(mols, screening_filters)

      columns = [ColumnData(name="Screening Filter", dataType=DataType.STRING,
                            values=filter_column),
                 ColumnData(name="Screening Filter Matches", dataType=DataType.STRING,
                            values=matches_column)
                 ]

      response = DataFunctionResponse(outputColumns=columns, notifications=notifications)
      return response

allowedClients:
  - Analyst
  - WebPlayer
demoUrl:
limitBy: none
minimumChartsVersion: 4.6.0.0
